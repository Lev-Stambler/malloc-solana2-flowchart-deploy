(this["webpackJsonpmalloc-flow-2"]=this["webpackJsonpmalloc-flow-2"]||[]).push([[0],{101:function(t,e,n){"use strict";var r=n(822);n.d(e,"MallocSdk",(function(){return r.a}));n(848);var a=n(985);n.d(e,"utils",(function(){return a}));n(851);var c=n(852);n.d(e,"builder",(function(){return c}));n(488)},1084:function(t,e,n){},1085:function(t,e,n){},1086:function(t,e){},1088:function(t,e){},1095:function(t,e){},1110:function(t,e){},1111:function(t,e){},1151:function(t,e){},1152:function(t,e){},1153:function(t,e){},1157:function(t,e){},1174:function(t,e){},1175:function(t,e){},1197:function(t,e){},1198:function(t,e){},1199:function(t,e){},1203:function(t,e){},1220:function(t,e){},1221:function(t,e){},1241:function(t,e){},1242:function(t,e){},1261:function(t,e){},1262:function(t,e){},1282:function(t,e){},1283:function(t,e){},1284:function(t,e){},1290:function(t,e){},1291:function(t,e){},1309:function(t,e){},1310:function(t,e){},1340:function(t,e){},1341:function(t,e){},1342:function(t,e){},1346:function(t,e){},1363:function(t,e){},1364:function(t,e){},1390:function(t,e){},1391:function(t,e){},1392:function(t,e){},1422:function(t,e){},1523:function(t,e){},1525:function(t,e){},1539:function(t,e){},1543:function(t,e){},1545:function(t,e){},1555:function(t,e){},1557:function(t,e){},1588:function(t,e){},1590:function(t,e){},1597:function(t,e){},1598:function(t,e){},1623:function(t,e){},1630:function(t,e,n){"use strict";n.r(e);var r,a=n(1),c=n.n(a),i=n(62),o=n.n(i),u=(n(1084),n(1085),n(13)),s=n(0),l=n.n(s),d=n(5),f=n(18),p=n(260),b=n(662),m=n(1690),h=n(1699),O=n(47),x=n(124),j=n(474),v=n(385),y=n(1703),A=n(16),g=n(1704),k=n(1705),w=n(146);!function(t){t.actionVertex="ACTION_VERTEX",t.tokenAccount="TOKEN_ACCOUNT",t.mintAccount="MINT_ACCOUNT",t.tokenAccountOnlyInit="TOKEN_ACCOUNT_ONLY_INIT",t.mintAccountOnlyInit="MINT_ACCOUNT_ONLY_INIT",t.wholeNumber="WHOLE_NUMBER",t.fractionNumber="FRACTION_NUMBER",t.other="OTHER"}(r||(r={}));var S=n(998),I=n.n(S),T=function(t,e){if(t){e||(e="console.json"),"object"===typeof t&&(t=JSON.stringify(t,void 0,4));var n=new Blob([t],{type:"text/json"}),r=document.createEvent("MouseEvents"),a=document.createElement("a");a.download=e,a.href=window.URL.createObjectURL(n),a.dataset.downloadurl=["text/json",a.download,a.href].join(":"),r.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),a.dispatchEvent(r)}else console.error("No data")},N=function(){var t=Object(d.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,I()({accept:"application/json"});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),C=function(t){return t[D]},M=function(t){return t[0][1].value},P=function(t){return t[1][1].value},K=function(t){return Object.keys(t)},R=function(t){return t.split("-")[0]},E=function(t,e){return t[e].next_actions.map((function(t){return t.slice(1).map((function(t){return t[1].value||t[0].value?{amount:parseInt(t[1].value),id:t[0].value}:null})).filter((function(t,e){return null!==t}))}))},_=function(t){return[{value:"",className:"".concat(r.actionVertex,"-").concat(t)},{value:"",className:r.wholeNumber}]},D="SOURCE-0",B=["SERUM_SWAP","TRANSFER","MINT"],L=[[{value:"NextActionID",readOnly:!0},{value:"Parts of 1,000",readOnly:!0}],_(0)],W={selected:D,counter:1,new_action:"SERUM_SWAP",graph:{},sourceMint:"<UNSET>",hiddenInputData:{}};W.graph[D]={input:[[{value:"InputTokenAccount",readOnly:!0},{value:"",className:r.tokenAccountOnlyInit}],[{value:"Amount",readOnly:!0},{value:"",className:r.fractionNumber}]],next_actions:[L]};var U=new w.Store(W),F=function(){var t=Object(d.a)(l.a.mark((function t(){var e,n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N();case 2:if(!((e=t.sent).length<1)){t.next=6;break}return alert("Please select a file"),t.abrupt("return");case 6:return t.t0=JSON,t.next=9,e[0].text();case 9:t.t1=t.sent,n=t.t0.parse.call(t.t0,t.t1),console.log(n),n.graph[D].input[0][1].value="",U.setState(n);case 14:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),G=function(){var t=Object(d.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,T(JSON.stringify(U.state),"flow.json");case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),H=n(446),V=n(451),Y=n(452),J=n(461),z={},q=function(t){z[t.actionTypeUID]=t};q(Y.b),q(J.a),q(H.a),q(V.a);var Q=n(386),X=n(122),Z=n(668),$=n(87),tt=new w.Store({derivedTokenAccounts:null,tokenList:null}),et=X.ASSOCIATED_TOKEN_PROGRAM_ID,nt=function(){var t=Object(d.a)(l.a.mark((function t(e){var n,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=function(){var t=Object(d.a)(l.a.mark((function t(){var e,n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!tt.state.tokenList){t.next=2;break}return t.abrupt("return",tt.state.tokenList);case 2:return t.next=4,(new Z.b).resolve();case 4:return e=t.sent,n=e.filterByClusterSlug(Object($.a)().solana.NETWORK).getList(),tt.setState(Object(u.a)(Object(u.a)({},tt.state),{},{tokenList:n})),t.abrupt("return",n);case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),t.next=3,n();case 3:if(r=t.sent,"devnet"!==Object($.a)().solana.NETWORK){t.next=15;break}return t.t0=[],t.t1=Object(A.a)(r),t.t2=A.a,t.next=10,rt(e);case 10:return t.t3=t.sent,t.t4=(0,t.t2)(t.t3),t.abrupt("return",t.t0.concat.call(t.t0,t.t1,t.t4));case 15:return t.abrupt("return",r);case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),rt=function(){var t=Object(d.a)(l.a.mark((function t(e){var n,r,a,c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new O.PublicKey(Object($.a)().demo.FAKE_USDC),r=new O.PublicKey(Object($.a)().demo.FAKE_TOKEN_A),t.next=4,ot(e,n);case 4:return a=t.sent,t.next=7,ot(e,r);case 7:if(c=t.sent,a&&c){t.next=10;break}throw"Expected info for these mints";case 10:return t.abrupt("return",[Object(u.a)(Object(u.a)({},a),{},{chainId:-1,name:"FAKE USDC",symbol:"FUSDC",address:Object($.a)().demo.FAKE_USDC}),Object(u.a)(Object(u.a)({},c),{},{chainId:-1,name:"FAKE: A TOKEN",symbol:"FA TOKEN",address:Object($.a)().demo.FAKE_TOKEN_A})]);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),at=function(){var t=Object(d.a)(l.a.mark((function t(e,n){var r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.PublicKey.findProgramAddress([e.toBuffer(),X.TOKEN_PROGRAM_ID.toBuffer(),new O.PublicKey(n).toBuffer()],et);case 2:return r=t.sent,t.abrupt("return",r[0]);case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),ct=function(){var t=Object(d.a)(l.a.mark((function t(e,n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.all(n.map((function(t){return at(e,t)}))));case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),it=function(){var t=Object(d.a)(l.a.mark((function t(e,n){var r,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.connection.getAccountInfo(n);case 2:if(r=t.sent){t.next=5;break}return t.abrupt("return",null);case 5:return t.prev=5,a=Object(Q.parseTokenAccount)(r.data),t.abrupt("return",a);case 10:return t.prev=10,t.t0=t.catch(5),console.error("An error occured parsing the data, returning null",t.t0),t.abrupt("return",null);case 14:case"end":return t.stop()}}),t,null,[[5,10]])})));return function(e,n){return t.apply(this,arguments)}}(),ot=function(){var t=Object(d.a)(l.a.mark((function t(e,n){var r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.connection.getAccountInfo(n);case 2:if(r=t.sent){t.next=5;break}return t.abrupt("return",null);case 5:return t.abrupt("return",Object(Q.parseMintAccount)(r.data));case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),ut=n(131),st=function(t){return new ut.a(new O.Connection(Object($.a)().solana.RPC),t,{})},lt=n(101),dt=function(t){if("SERUM_SWAP"===t)return Y.a.actionTypeUID;if("TRANSFER"===t)return J.a.actionTypeUID;if("MINT"===t)return V.a.actionTypeUID;throw"unexpected vertex id of ".concat(t)},ft=function(t){if("SERUM_SWAP"===t)return Object($.a)().mallocSpl.SWAP_PROGRAM_ID;if("TRANSFER"===t)return Object($.a)().mallocSpl.TRANSFER_PROGRAM_ID;if("MINT"===t)return Object($.a)().mallocSpl.MINT_TO;throw"unexpected vertex id of ".concat(t)},pt=n(23),bt=function(){var t=Object(w.useStore)(U),e=B,n=(Object(x.useAnchorWallet)(),{maxWidth:"20px",maxHeight:"20px",minWidth:"20px",minHeight:"20px"}),c=Object(a.useState)(!1),i=Object(f.a)(c,2),o=(i[0],i[1],Object(a.useState)(!1)),s=Object(f.a)(o,2);s[0],s[1];return Object(pt.jsxs)(y.a,{children:[Object(pt.jsxs)(g.a,{children:[Object(pt.jsx)("h2",{children:"Node Id"}),Object(pt.jsx)("select",{id:"node-selector",className:"form-select",size:10,"aria-label":"size 3 select example",style:{width:"200px"},onChange:function(t){U.setState({selected:t.target.value})},children:Object.keys(t.graph).map((function(t,e){return Object(pt.jsx)("option",{value:t,children:t})}))})]}),Object(pt.jsx)("select",{className:"form-select","aria-label":"Default select example",onChange:function(t){U.setState({new_action:t.target.value})},children:e.map((function(t,e){return Object(pt.jsx)("option",{value:t,children:t})}))}),Object(pt.jsx)(k.a,{variant:"text",style:n,onClick:function(){var e=t.new_action+"-"+t.counter.toString(),n=function(t){switch(t){case"MINT":return{input:[[{value:"decimals",readOnly:!0},{value:"6",className:r.wholeNumber}],[{value:"initialSupply",readOnly:!0},{value:"",className:r.fractionNumber}]]};case"TRANSFER":return{input:[[{value:"recipientWallet",readOnly:!0},{value:"",className:r.other}]]};case"SERUM_SWAP":return{input:[[{value:"outMint",readOnly:!0},{value:"",className:r.mintAccount}],[{value:"minOut",readOnly:!0},{value:"",className:r.wholeNumber}]],hiddenData:{rent:O.SYSVAR_RENT_PUBKEY.toBase58(),serumDexProgramId:Object($.a)().projectSerum.DEX_PROGRAM_ID}};default:throw"Unexpected action type ".concat(t)}}(t.new_action),a={input:n.input,next_actions:Object(A.a)(Array(z[dt(t.new_action)].expectedNumberOfOutMints)).map((function(t){return L}))};t.graph[e]=a,t.hiddenInputData[e]=n.hiddenData||{},U.setState(Object(u.a)(Object(u.a)({},t),{},{selected:e,counter:t.counter+1,graph:Object(u.a)({},t.graph)}))},children:"+"}),Object(pt.jsx)(k.a,{variant:"text",style:n,onClick:function(){"SOURCE-0"!=t.selected&&(delete t.graph[t.selected],U.setState(Object(u.a)(Object(u.a)({},t),{},{selected:"SOURCE-0",graph:Object(u.a)({},t.graph)})))},children:"-"})]})},mt=n(1706),ht=n(665),Ot=n(1019),xt=n(1700),jt=n(1697),vt=n(1007),yt=n.n(vt),At=n(806),gt=n(984),kt=n(1691);function wt(){return{top:"".concat(50,"%"),left:"".concat(50,"%"),transform:"translate(-".concat(50,"%, -").concat(50,"%)")}}var St=Object(At.a)((function(t){return Object(gt.a)({paper:{position:"absolute",width:"auto",backgroundColor:t.palette.background.paper,border:"2px solid #000",boxShadow:t.shadows[5],padding:t.spacing(2,4,3)}})})),It=function(t){var e=t.tok,n=t.setChoosen;return Object(pt.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr 1fr",width:"100%",gap:"5px"},children:[Object(pt.jsx)("button",{onClick:n,children:"Choose"}),Object(pt.jsx)("div",{children:e.info.name}),Object(pt.jsx)("div",{children:Object(v.a)(e.info.mint.toBase58())}),Object(pt.jsxs)("div",{children:[Object(v.a)(e.account),e.balance?"":" (currently nonexistent)"]}),Object(pt.jsx)("div",{children:lt.utils.tokens.toReadableNumber(new X.u64(e.balance||0),e.info.decimals)})]})};function Tt(t){var e,n=null===(e=t.onlyWithInitializedAccounts)||void 0===e||e,r=St(),i=c.a.useState(wt),o=Object(f.a)(i,1)[0],s=c.a.useState(!1),p=Object(f.a)(s,2),b=p[0],m=p[1],h=c.a.useState(""),j=Object(f.a)(h,2),v=j[0],y=j[1],A=c.a.useState(""),g=Object(f.a)(A,2),k=g[0],S=g[1],I=Object(x.useAnchorWallet)(),T=Object(a.useState)(-1),N=Object(f.a)(T,2),C=N[0],M=N[1],P=Object(w.useStore)(tt),K=st(I),R=function(){var t=Object(d.a)(l.a.mark((function t(){var e,r,a,c,i,o;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,nt(K);case 2:return e=t.sent,t.next=5,ct(null===I||void 0===I?void 0:I.publicKey,e.map((function(t){return t.address})));case 5:return r=t.sent,t.next=8,Promise.all(r.map(function(){var t=Object(d.a)(l.a.mark((function t(e){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,it(K,e);case 2:return n=t.sent,t.abrupt("return",null===n||void 0===n?void 0:n.amount);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 8:a=t.sent,c=r.map((function(t,n){return{account:t.toBase58(),info:e[n],balance:a[n]}})),i=n?c.filter((function(t){return t.balance})):c,o=i.map((function(t){var e;return Object(u.a)(Object(u.a)({},t),{},{info:Object(u.a)(Object(u.a)({},t.info),{},{mint:new O.PublicKey(t.info.address)}),balance:(null===(e=t.balance)||void 0===e?void 0:e.toString())||null})})),tt.setState(Object(u.a)(Object(u.a)({},P),{},{derivedTokenAccounts:o}));case 13:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();Object(a.useEffect)((function(){R()}),[]);Object(a.useRef)(null);var E=function(){var e=Object(d.a)(l.a.mark((function e(){var n,r,a,c,i,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(P.derivedTokenAccounts){e.next=4;break}return m(!1),t.onClose(),e.abrupt("return");case 4:if(!(C>=0)){e.next=8;break}t.onClose(P.derivedTokenAccounts[C]),e.next=45;break;case 8:if(("TOKEN"!==(n=-1===C?"TOKEN":"MINT")||v)&&("MINT"!==n||k)){e.next=13;break}return m(!1),t.onClose(),e.abrupt("return");case 13:if("TOKEN"!==n){e.next=17;break}e.t0=v,e.next=20;break;case 17:return e.next=19,at(I.publicKey,k);case 19:e.t0=e.sent.toBase58();case 20:return r=e.t0,e.next=23,it(K,new O.PublicKey(r));case 23:if(a=e.sent,"TOKEN"!==n||a){e.next=29;break}return alert("Looks like an invalid SPL Token Account was provided"),m(!1),t.onClose(),e.abrupt("return");case 29:if("MINT"!==n||!1===t.onlyWithInitializedAccounts||a){e.next=34;break}return alert("Looks like there is no initialized associated account with this mint"),m(!1),t.onClose(),e.abrupt("return");case 34:return c="TOKEN"===n?a.mint:new O.PublicKey(k),e.next=37,ot(K,c);case 37:if(i=e.sent){e.next=43;break}return alert("Looks like the mint associated with this token is invalid"),m(!1),t.onClose(),e.abrupt("return");case 43:o=(null===a||void 0===a?void 0:a.amount)||new X.u64(0),t.onClose({balance:o,account:r,info:Object(u.a)(Object(u.a)({},i),{},{mint:c})});case 45:m(!1),t.onClose();case 47:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_=Object(pt.jsx)("div",{onBlur:E,className:"wrapper",onClick:function(t){return t.currentTarget.blur()},style:{position:"fixed",top:"0",left:"0",height:"100vh",width:"100vw",zIndex:100,display:"grid",justifyItems:"center",justifyContent:"center",alignItems:"center"},children:Object(pt.jsxs)("div",{style:Object(u.a)({},o),className:r.paper,children:[Object(pt.jsx)("h2",{id:"simple-modal-title",children:"Choose a token account"}),Object(pt.jsx)("p",{id:"simple-modal-description",children:"Choose from either your associated token accounts or add a custom address"}),Object(pt.jsxs)("div",{className:"options",style:{overflow:"scroll",maxHeight:"70vh"},children:[Object(pt.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr 1fr"},children:[Object(pt.jsx)("span",{}),Object(pt.jsx)("div",{children:"Mint Name"}),Object(pt.jsx)("div",{children:"Mint Address"}),Object(pt.jsx)("div",{children:"Token Account Address"}),Object(pt.jsx)("div",{children:"Amount"})]}),P.derivedTokenAccounts?P.derivedTokenAccounts.map((function(t,e){return Object(pt.jsxs)("div",{style:{padding:"0.5rem",border:C===e?"1px solid black":"0px"},children:[Object(pt.jsx)(It,{tok:t,setChoosen:function(){M(e)}}),Object(pt.jsx)("br",{})]},"token-derived-account-".concat(e))})):"Loading...",t.includeCustomTokenAccount&&Object(pt.jsx)("div",{style:{padding:"0.5rem",border:-1===C?"1px solid black":"0px"},children:Object(pt.jsx)(kt.a,{label:"Custom Token Account",value:v,onChange:function(t){return y(t.target.value)},onFocus:function(){return M(-1)}})}),Object(pt.jsx)("p",{children:"Or"}),Object(pt.jsx)("div",{style:{padding:"0.5rem",border:-2===C?"1px solid black":"0px"},children:Object(pt.jsx)(kt.a,{label:"Custom Mint Account",value:k,onChange:function(t){return S(t.target.value)},onFocus:function(){return M(-2)}})})]})]})});return Object(pt.jsxs)("div",{children:[Object(pt.jsx)("button",{type:"button",onClick:function(){R(),m(!0)},children:t.buttonText||"Choose Token Account"}),b&&_]})}var Nt,Ct,Mt=function(t){var e;return Object(pt.jsx)(Ot.a,{onChange:function(e){t.onChange(Object(u.a)(Object(u.a)({},t.cell),{},{value:t.isWholeNumber?parseInt(e.target.value).toString():e.target.value}))},value:(null===(e=t.cell)||void 0===e?void 0:e.value)||"",type:t.isFractionNumber||t.isWholeNumber?"number":"text"})},Pt=function(t){return Object(pt.jsx)("div",{children:Object(pt.jsx)(Tt,{buttonText:"select",onlyWithInitializedAccounts:t.onlyWithInitialized,onClose:function(e){if(e){var n="token"===t.type?e.account:e.info.mint.toBase58();t.onChange(Object(u.a)(Object(u.a)({},t.cell),{},{value:n}))}}})})},Kt=function(t){var e,n=function(t){var e=Object.keys(t),n=e.indexOf(D);return e.splice(n,1),e}(Object(w.useStore)(U).graph),r=Object(a.useState)(!0),c=Object(f.a)(r,2),i=c[0],o=c[1],s=Object(a.useState)(!1),l=Object(f.a)(s,2),d=l[0],p=l[1];return Object(pt.jsx)("div",{children:Object(pt.jsx)(yt.a,{active:i,paused:d,children:Object(pt.jsx)(jt.a,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:null===(e=t.cell)||void 0===e?void 0:e.value,label:"Age",style:{height:"20px"},children:n.map((function(e){return Object(pt.jsx)("span",{children:Object(pt.jsx)(xt.a,{style:{zIndex:100},value:e,onMouseOver:function(){return p(!0)},onFocus:function(){return function(e){t.onChange(Object(u.a)(Object(u.a)({},t.cell),{},{value:e})),o(!1)}(e)},children:e})},"select-opts-".concat(e))}))})})})},Rt=function(t){var e;switch(((null===(e=t.cell)||void 0===e?void 0:e.className)||"").split("-")[0]){case r.actionVertex:var n=parseInt(t.cell.className.split("-")[1]||"");return Kt(Object(u.a)(Object(u.a)({},t),{},{nextActionMintIdx:n}));case r.mintAccountOnlyInit:return Pt(Object(u.a)(Object(u.a)({},t),{},{type:"mint",onlyWithInitialized:!0}));case r.tokenAccountOnlyInit:return Pt(Object(u.a)(Object(u.a)({},t),{},{type:"token",onlyWithInitialized:!0}));case r.mintAccount:return Pt(Object(u.a)(Object(u.a)({},t),{},{type:"mint",onlyWithInitialized:!1}));case r.tokenAccount:return Pt(Object(u.a)(Object(u.a)({},t),{},{type:"token",onlyWithInitialized:!1}));case r.other:return Mt(t);case r.wholeNumber:return Mt(Object(u.a)(Object(u.a)({},t),{},{isWholeNumber:!0}));case r.fractionNumber:return Mt(Object(u.a)(Object(u.a)({},t),{},{isFractionNumber:!0}));default:return Mt(t)}},Et=function(){var t=Object(w.useStore)(U),e=Object(x.useAnchorWallet)(),n=function(){var n=Object(d.a)(l.a.mark((function n(r){var a,c,i;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.graph[t.selected].input=r,a=t.sourceMint,t.selected!==D){n.next=9;break}if(!(c=M(r))){n.next=9;break}return n.next=7,it(st(e),new O.PublicKey(c));case 7:(i=n.sent)&&(a=i.mint.toBase58());case 9:U.setState(Object(u.a)(Object(u.a)({},t),{},{sourceMint:a,graph:Object(u.a)({},t.graph)}));case 10:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}();return Object(pt.jsx)(y.a,{children:Object(pt.jsxs)(g.a,{children:[Object(pt.jsxs)("h2",{children:[t.selected," info"]}),t.selected===D&&Object(pt.jsxs)("p",{children:["Source Mint: ",t.sourceMint]}),Object(pt.jsx)("h5",{children:"Input"}),Object(pt.jsx)(ht.a,{data:t.graph[t.selected].input,onChange:function(t){return n(t)},DataEditor:Rt}),Object(pt.jsx)("h5",{children:"Next Action"}),t.graph[t.selected].next_actions.map((function(e,n){return Object(pt.jsxs)("div",{children:[Object(pt.jsx)(ht.a,{data:t.graph[t.selected].next_actions[n],onChange:function(e){t.graph[t.selected].next_actions[n]=function(t){for(var e=lt.utils.object.deepCloneObject(t),n=0;n<e.length;n++)"MINT"===R(e[n][0].value)&&(e[n][1].value="0",e[n][1].readOnly=!0);return e}(e),U.setState(Object(u.a)(Object(u.a)({},t),{},{graph:Object(u.a)({},t.graph)})),console.log(t.graph[t.selected].next_actions)},DataEditor:Rt}),Object(pt.jsxs)(mt.a,{children:[Object(pt.jsx)(k.a,{variant:"outlined",onClick:function(){t.graph[t.selected].next_actions[n]=[].concat(Object(A.a)(t.graph[t.selected].next_actions[n]),[_(n)]),U.setState(Object(u.a)(Object(u.a)({},t),{},{graph:Object(u.a)({},t.graph)})),console.log("new action",t.graph[t.selected].next_actions)},children:"New Action"}),Object(pt.jsx)(k.a,{variant:"outlined",onClick:function(){if(t.graph[t.selected].next_actions.length>2){var e=t.graph[t.selected].next_actions;t.graph[t.selected].next_actions=e.slice(0,e.length-1),U.setState(Object(u.a)(Object(u.a)({},t),{},{graph:Object(u.a)({},t.graph)})),console.log("remove action",t.graph[t.selected].next_actions)}},children:"Remove Action"})]})]},"next-action-".concat(n))}))]})})},_t=n(216),Dt=function(t){var e=Object(a.useState)([5,3,6,1,2]),n=Object(f.a)(e,2),r=n[0],c=n[1],i=Object(a.useRef)();Object(a.useEffect)((function(){var t=[{id:"Microsoft"},{id:"Amazon"},{id:"HTC"}],e=[{source:"Microsoft",target:"Amazon",type:"licensing"},{source:"Microsoft",target:"HTC",type:"licensing"}],n=["licensing"],r={nodes:t,links:e},a=_t.g(n,_t.h),c=function(t){var e=Math.hypot(t.target.x-t.source.x,t.target.y-t.source.y);return"\n              M".concat(t.source.x,",").concat(t.source.y,"\n              A").concat(e,",").concat(e," 0 0,1 ").concat(t.target.x,",").concat(t.target.y,"\n            ")};e=r.links.map((function(t){return Object.create(t)})),t=r.nodes.map((function(t){return Object.create(t)}));var o=_t.d(t).force("link",_t.b(e).id((function(t){return t.id}))).force("charge",_t.c().strength(-400)).force("x",_t.e()).force("y",_t.f()),u=_t.i(i.current).attr("viewBox",[-150,-150,300,300]).style("font","12px sans-serif");u.append("defs").selectAll("marker").data(n).join("marker").attr("id",(function(t){return"arrow-".concat(t)})).attr("viewBox","0 -5 10 10").attr("refX",15).attr("refY",-.5).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("path").attr("fill",a).attr("d","M0,-5L10,0L0,5");var s=u.append("g").attr("fill","none").attr("stroke-width",1.5).selectAll("path").data(e).join("path").attr("stroke",(function(t){return a(t.type)})).attr("marker-end",(function(t){return"url(".concat(new URL("#arrow-".concat(t.type),location),")")})),l=u.append("g").attr("fill","currentColor").attr("stroke-linecap","round").attr("stroke-linejoin","round").selectAll("g").data(t).join("g").call(function(t){return _t.a().on("start",(function(e,n){e.active||t.alphaTarget(.3).restart(),n.fx=n.x,n.fy=n.y})).on("drag",(function(t,e){e.fx=t.x,e.fy=t.y})).on("end",(function(e,n){e.active||t.alphaTarget(0),n.fx=null,n.fy=null}))}(o));l.append("circle").attr("stroke","white").attr("stroke-width",1.5).attr("r",4),l.append("text").attr("x",8).attr("y","0.31em").text((function(t){return t.id})).clone(!0).lower().attr("fill","none").attr("stroke","white").attr("stroke-width",3),o.on("tick",(function(){s.attr("d",c),l.attr("transform",(function(t){return"translate(".concat(t.x,",").concat(t.y,")")}))}))}),[]);return Object(pt.jsxs)("div",{style:{border:"2px solid black",padding:"10px",width:"300px"},children:[Object(pt.jsx)("svg",{ref:i}),Object(pt.jsx)("br",{}),Object(pt.jsx)("button",{onClick:function(){var t=r.map((function(t){return t+5}));c(t)},children:"Update"}),Object(pt.jsx)("br",{}),Object(pt.jsx)("button",{onClick:function(){var t=Object(A.a)(r);t.pop(),c(t)},children:"Remove"})]})},Bt=function(t){if(console.error(t),"MALLOC_FLOWCHART_ERROR"!==(null===t||void 0===t?void 0:t.errorType))throw alert("An unexpected error occured: ".concat(t)),t;var e=t;if(alert(e.msg),e.fullError)throw e.fullError},Lt=function(t){return Ft("The token account ".concat(t.toString()," does not exist"))},Wt=function(t){return Ft("".concat(t," is not a valid number for the input"))},Ut=function(t,e){return Ft(e?"The mint ".concat(t.toString()," found from token ").concat(e.toString()," does not exist"):"The mint ".concat(t.toString()," does not exist"))},Ft=function(t,e){return{msg:t,fullError:e,type:"MALLOC_FLOWCHART_ERROR"}},Gt=new O.PublicKey(Object($.a)().MALLOC_PROGRAM_ID),Ht=function(t){return new lt.MallocSdk(Gt,st(t))},Vt=function(t,e){var n={};return t.map((function(t){n[t[0].value]=t[1].value})),Object(u.a)(Object(u.a)({},n),e)},Yt=function(t,e,n,r){var a=function(t,e){return K(e).filter((function(n){return E(e,n).some((function(e){return e.map((function(t){return t.id})).includes(t)}))}))}(t,n),c=function(t,e,n){return E(n,e).map((function(e){return e.map((function(e){return{actionIdx:t.indexOf(e.id),fraction:e.amount}}))}))}(e,t,n),i=R(t);return{actionTypeUID:dt(i),buildActionInputs:Vt(n[t].input,r[t]),actionPID:ft(i),actionMetadata:{ripeAmount:a.length,nextNodes:c}}},Jt=function(){var t=Object(d.a)(l.a.mark((function t(e,n,r,a,c,i){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return K(e),t.abrupt("return",{actionDatas:r.map((function(t){return Yt(t,r,e,n)})),initialSplits:a,initialActionIndices:c,amount:i});case 2:case"end":return t.stop()}}),t)})));return function(e,n,r,a,c,i){return t.apply(this,arguments)}}(),zt=function(){var t=Object(d.a)(l.a.mark((function t(e,n,r,a){var c,i,o,u,s,d,f;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=C(e),t.next=3,it(a,n);case 3:if(i=t.sent){t.next=6;break}throw Lt(n);case 6:return o=i.mint,t.next=9,ot(a,o);case 9:if(u=t.sent){t.next=12;break}throw Ut(o,n);case 12:t.prev=12,s=parseFloat(P(c.input)),t.next=19;break;case 16:throw t.prev=16,t.t0=t.catch(12),Wt(P(c.input));case 19:return d=lt.utils.tokens.fromReadableNumber(s,u.decimals),f=E(e,D)[0],t.abrupt("return",{amount:d,initialMint:o,initialSplits:f.map((function(t){return t.amount})),initialActionIndices:f.map((function(t){return r.indexOf(t.id)}))});case 22:case"end":return t.stop()}}),t,null,[[12,16]])})));return function(e,n,r,a){return t.apply(this,arguments)}}(),qt=function(){var t=Object(d.a)(l.a.mark((function t(e,n){var r,a,c,i,o,u,s,d,f,p,b,m,h,x;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=U.state,a=r.graph,c=r.hiddenInputData,i=new O.PublicKey(M(C(a).input)),o=st(e),u=K(a),s=u.slice(1),t.next=7,zt(a,i,s,o);case 7:return d=t.sent,f=d.initialSplits,p=d.initialActionIndices,b=d.initialMint,m=d.amount,t.next=14,Jt(a,c,s,f,p,m);case 14:return h=t.sent,t.next=17,lt.builder.buildConstructionFromNonUserSpecific(h,z,i.toBase58(),b.toBase58(),o);case 17:return x=t.sent,t.abrupt("return",{actions:x.actions,initialSplits:x.initialSplits,amount:x.amount,initialActionIndices:x.initialActionIndices,amountInAccount:i,opts:{preferredTokenAccounts:n}});case 19:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),Qt=function(){var t=Object(d.a)(l.a.mark((function t(e,n){var r,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Ht(n),t.next=3,r.buildTxs(e);case 3:return a=t.sent,t.next=6,r.sendRequests(a,{prepareCommitment:{skipPreflight:!1,preflightCommitment:"single",commitment:"single"},actionCommitment:{skipPreflight:!1,preflightCommitment:"single",commitment:"single"}});case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),Xt=function(){var t=Object(d.a)(l.a.mark((function t(e){var n,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,qt(e);case 3:return n=t.sent,t.next=6,Qt(n,e);case 6:r=t.sent,alert("DONE AND SUCCESSFUL with tx: ".concat(r)),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),Bt(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}(),Zt=new Uint8Array([8,57,204,222,105,129,113,8,245,54,20,45,122,175,82,37,32,44,46,6,54,35,168,208,213,194,164,50,97,226,134,119,136,196,213,189,243,233,16,53,22,220,245,4,17,203,251,233,20,7,178,5,36,19,66,89,210,148,19,225,117,61,214,253]),$t=new ut.b(O.Keypair.fromSecretKey(Zt)),te=function(t){return new Q.Provider(new O.Connection(t),$t,{commitment:"confirmed"})},ee=function(){var t=Object(d.a)(l.a.mark((function t(e){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ne(new O.PublicKey(Object($.a)().demo.FAKE_USDC),e,te(Object($.a)().solana.RPC));case 3:return n=t.sent,t.next=6,re(new O.PublicKey(Object($.a)().demo.FAKE_USDC_GD),[n]);case 6:alert("Done with your airdrop"),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0),alert("An error occurred with the airdrop ".concat(JSON.stringify(t.t0)));case 13:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}(),ne=function(){var t=Object(d.a)(l.a.mark((function t(e,n,r){var a,c,i;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,O.PublicKey.findProgramAddress([n.toBuffer(),X.TOKEN_PROGRAM_ID.toBuffer(),new O.PublicKey(e).toBuffer()],X.ASSOCIATED_TOKEN_PROGRAM_ID);case 2:return a=t.sent[0],t.next=5,r.connection.getAccountInfo(a);case 5:if(t.sent){t.next=13;break}return c=X.Token.createAssociatedTokenAccountInstruction(X.ASSOCIATED_TOKEN_PROGRAM_ID,X.TOKEN_PROGRAM_ID,e,a,n,r.wallet.publicKey),(i=new O.Transaction).add(c),t.next=12,r.send(i,[]);case 12:case 13:return t.abrupt("return",a);case 14:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),re=function(){var t=Object(d.a)(l.a.mark((function t(e,n){var r,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return 6,r=4*Math.pow(10,6),a=new O.Transaction,n.map((function(t){a.add(X.Token.createTransferInstruction(X.TOKEN_PROGRAM_ID,e,t,$t.publicKey,[],r))})),t.next=6,te(Object($.a)().solana.RPC).send(a,[],{skipPreflight:!0});case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),ae=function(){Object(w.useStore)(U);var t=Object(x.useAnchorWallet)(),e=Object(a.useState)(!1),n=Object(f.a)(e,2),r=n[0],c=n[1],i=Object(a.useState)(!1),o=Object(f.a)(i,2),u=o[0],s=o[1];return Object(pt.jsxs)(y.a,{children:[Object(pt.jsxs)(g.a,{children:[Object(pt.jsx)("h2",{children:"Visualizer"}),Object(pt.jsx)(Dt,{})]}),Object(pt.jsxs)(mt.a,{children:[Object(pt.jsx)(k.a,{variant:"outlined",disabled:u,onClick:function(){s(!0),Xt(t).then((function(t){return s(!1)})).catch((function(t){return s(!1)}))},children:u?"Running...":"Compile and Run"}),Object(pt.jsx)(k.a,{variant:"outlined",onClick:function(){c(!0),ee(t.publicKey).then((function(t){return c(!1)}))},disabled:r,children:r?"Loading Airdrop...":"Airdrop Fake USDC"}),Object(pt.jsx)(k.a,{variant:"outlined",onClick:function(){return F()},children:"Import"}),Object(pt.jsx)(k.a,{variant:"outlined",onClick:function(){return G()},children:"Export"})]})]})},ce=function(){return Object(pt.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"center",gap:"10px"},children:Object(pt.jsx)(y.a,{children:Object(pt.jsxs)("div",{style:{width:"100%",display:"flex",justifyContent:"space-around",alignItems:"flex-start",gap:"10px"},children:[Object(pt.jsx)(bt,{}),Object(pt.jsx)(Et,{}),Object(pt.jsx)(ae,{})]})})})},ie=Object(b.a)(j.WalletDialogButton)(Nt||(Nt=Object(p.a)([""]))),oe=(b.a.span(Ct||(Ct=Object(p.a)([""]))),function(t){var e,n=Object(a.useState)(),r=Object(f.a)(n,2),c=r[0],i=r[1],o=Object(a.useState)(!1),s=Object(f.a)(o,2),p=(s[0],s[1],Object(a.useState)(!1)),b=Object(f.a)(p,2),j=(b[0],b[1],Object(a.useState)(!1)),y=Object(f.a)(j,2),A=(y[0],y[1],Object(a.useState)({open:!1,message:"",severity:void 0})),g=Object(f.a)(A,2),k=g[0],w=g[1],S=Object(x.useWallet)();return Object(a.useEffect)((function(){Object(d.a)(l.a.mark((function e(){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===S||void 0===S?void 0:S.publicKey)){e.next=5;break}return e.next=3,t.connection.getBalance(S.publicKey);case 3:n=e.sent,i(n/O.LAMPORTS_PER_SOL);case 5:case"end":return e.stop()}}),e)})))()}),[S,t.connection]),Object(pt.jsxs)("main",{children:[S.connected&&Object(pt.jsxs)("p",{style:{marginTop:0},children:["Address: ",Object(v.a)((null===(e=S.publicKey)||void 0===e?void 0:e.toBase58())||"")]}),S.connected&&Object(pt.jsxs)("p",{children:["Balance: ",(c||0).toLocaleString()," SOL"]}),S.connected&&"WALLET CONNECTED",!S.connected&&Object(pt.jsx)(ie,{children:"Connect Wallet"}),Object(pt.jsx)(m.a,{open:k.open,autoHideDuration:6e3,onClose:function(){return w(Object(u.a)(Object(u.a)({},k),{},{open:!1}))},children:Object(pt.jsx)(h.a,{onClose:function(){return w(Object(u.a)(Object(u.a)({},k),{},{open:!1}))},severity:k.severity,children:k.message})}),S.connected&&Object(pt.jsx)(ce,{})]})}),ue=n(517),se=new ut.d.PublicKey(Object($.a)().MALLOC_PROGRAM_ID),le=Object($.a)().solana.NETWORK,de=Object($.a)().solana.RPC,fe=new ut.d.Connection(de),pe=function(){var t=Object(a.useMemo)((function(){return Object(O.clusterApiUrl)(le)}),[]),e=Object(a.useMemo)((function(){return[Object(ue.getPhantomWallet)(),Object(ue.getSolflareWallet)(),Object(ue.getSolletWallet)()]}),[]);return Object(pt.jsx)(x.ConnectionProvider,{endpoint:t,children:Object(pt.jsx)(x.WalletProvider,{wallets:e,autoConnect:!0,children:Object(pt.jsx)(j.WalletDialogProvider,{children:Object(pt.jsx)(oe,{config:se,connection:fe,txTimeout:3e4})})})})},be=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,1709)).then((function(e){var n=e.getCLS,r=e.getFID,a=e.getFCP,c=e.getLCP,i=e.getTTFB;n(t),r(t),a(t),c(t),i(t)}))};o.a.render(Object(pt.jsx)(c.a.StrictMode,{children:Object(pt.jsx)(pe,{})}),document.getElementById("root")),be()},215:function(t,e,n){"use strict";var r,a;n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return a})),function(t){t[t.Bid=0]="Bid",t[t.Ask=1]="Ask"}(r||(r={})),function(t){t[t.BasicSwap=0]="BasicSwap"}(a||(a={}))},261:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"d",(function(){return a})),n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return i})),n.d(e,"e",(function(){return o}));var r=2e4,a=5184e5,c=5184e5,i=19.055,o=1728e5},282:function(t,e,n){"use strict";n.r(e),n.d(e,"tryCreateAssociatedAccountInst",(function(){return l})),n.d(e,"tryCreateAssociatedAccount",(function(){return d})),n.d(e,"transferToTx",(function(){return f})),n.d(e,"getTokenAccountUsedByMalloc",(function(){return p})),n.d(e,"createTokenAccountsForActions",(function(){return b})),n.d(e,"toReadableNumber",(function(){return x})),n.d(e,"fromReadableNumber",(function(){return j}));var r=n(16),a=n(0),c=n.n(a),i=n(5),o=n(996),u=n(150),s=n(111),l=function(){var t=Object(i.a)(c.a.mark((function t(e,n,r,a){var i,o;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.b.findProgramAddress([n.toBuffer(),u.b.toBuffer(),new s.b(e).toBuffer()],u.a);case 2:return i=t.sent[0],t.next=5,r.getAccountInfo(i);case 5:if(t.sent){t.next=11;break}return o=u.c.createAssociatedTokenAccountInstruction(u.a,u.b,new s.b(e),i,n,a),t.abrupt("return",{instr:o,associateTokAccount:i});case 11:return t.abrupt("return",{associateTokAccount:i});case 12:case"end":return t.stop()}}),t)})));return function(e,n,r,a){return t.apply(this,arguments)}}(),d=function(){var t=Object(i.a)(c.a.mark((function t(e,n,r){var a,i,o,u;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l(e,n,r.connection,r.wallet.publicKey);case 2:if(a=t.sent,i=a.associateTokAccount,o=a.instr){t.next=7;break}return t.abrupt("return",i);case 7:return(u=new s.d).add(o),t.next=11,r.send(u);case 11:return t.abrupt("return",i);case 12:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),f=function(){var t=Object(i.a)(c.a.mark((function t(e,n,r,a){var i,u,l;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=a.secretKey?[a]:[],u=Object(o.transfer)({source:e,destination:n,amount:r,owner:a.publicKey}),(l=new s.d).add(u),t.abrupt("return",{tx:l,signers:i});case 5:case"end":return t.stop()}}),t)})));return function(e,n,r,a){return t.apply(this,arguments)}}(),p=function(){var t=Object(i.a)(c.a.mark((function t(e,n,r){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r||!r[n.toBase58()]){t.next=2;break}return t.abrupt("return",r[n.toBase58()]);case 2:return t.next=4,m(e,n);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),b=function(){var t=Object(i.a)(c.a.mark((function t(e,n,a,o,l){var d,f,p,b,O,x;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:d=h(a.map((function(t){var e,n,a=[];if(null===(e=t.tokenCreationOptions)||void 0===e?void 0:e.skipOutTokenCreations){var c=t.tokenCreationOptions.skipOutTokenCreations;console.log(c),t.tokenMintOuts.forEach((function(t,e){c.includes(e)||a.push(t)}))}else a.push.apply(a,Object(r.a)(t.tokenMintOuts));return!0===(null===(n=t.tokenCreationOptions)||void 0===n?void 0:n.skipInTokenCreation)||a.push(t.tokenMintIn),a})).flat()),console.log(d),f={},p=0;case 4:if(!(p<d.length)){t.next=17;break}if(b=d[p],!(l||{})[b]){t.next=10;break}f[b]={publicKey:l[b]},t.next=14;break;case 10:return t.next=12,m(n.publicKey,b);case 12:O=t.sent,f[b]={publicKey:O};case 14:p++,t.next=4;break;case 17:return t.next=19,Promise.all(d.map(function(){var t=Object(i.a)(c.a.mark((function t(r){var a,i,l,d;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=f[r].publicKey,t.next=3,e.connection.getAccountInfo(a);case 3:if(!t.sent){t.next=7;break}return console.log("ALREADY EXISTS"),t.abrupt("return",null);case 7:return i=u.c.createAssociatedTokenAccountInstruction(u.a,u.b,new s.b(r),f[r].publicKey,n.publicKey,o.publicKey),(l=new s.d).add(i),d=o.secretKey?[o]:[],t.abrupt("return",{tx:l,signers:d});case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 19:return x=t.sent,t.abrupt("return",{accounts:f,txs:x.filter((function(t){return!!t}))});case 21:case"end":return t.stop()}}),t)})));return function(e,n,r,a,c){return t.apply(this,arguments)}}(),m=function(){var t=Object(i.a)(c.a.mark((function t(e,n){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.b.findProgramAddress([e.toBuffer(),u.b.toBuffer(),new s.b(n).toBuffer()],u.a);case 2:return t.abrupt("return",t.sent[0]);case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),h=function(t){return Object(r.a)(new Set(t.map(O)))},O=function(t){return t.toBase58()},x=function(t,e){var n=t.toString(),r=n.substring(0,n.length-e)||"0",a=n.substring(n.length-e).padStart(e,"0").substring(0,e);return"".concat(function(t){for(var e=/(-?\d+)(\d{3})/;e.test(t);)t=t.replace(e,"$1,$2");return t}(r),".").concat(a).replace(/\.?0*$/,"")},j=function(t,e){var n,r=t.toString().split("."),a=r[0],c=r[1]||"";if(r.length>2||c.length>e)throw new Error("Cannot parse '".concat(t,"' as token amount"));return""===(n=(n=a+c.padEnd(e,"0")).replace(/^0+/,""))?"0":n}},378:function(t,e,n){"use strict";n.r(e),n.d(e,"deepCloneObject",(function(){return r}));var r=function(t){return function t(e){if(null==e||"object"!=typeof e)return e;var n=e.constructor();for(var r in e)n[r]=t(e[r]);return n}(t)}},385:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return a}));n(0),n(5);var r=n(131),a=(n(101),n(122),n(87),n(47),new r.d.PublicKey("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"),new r.d.PublicKey("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;return"".concat(t.slice(0,e),"...").concat(t.slice(-e))})}).call(this,n(6).Buffer)},446:function(t,e,n){"use strict";(function(t){var r=n(0),a=n.n(r),c=n(16),i=n(5),o=n(60),u=n(101),s=n(334),l=function(){var t=Object(i.a)(a.a.mark((function t(e,n,r,i,l,f){var p,b,m,h,O;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return p=parseInt(e.decimals),b=new o.b,m=u.utils.tokens.fromReadableNumber(parseFloat(e.amountOut),p),t.next=5,u.utils.tokens.getTokenAccountUsedByMalloc(l.wallet.publicKey,b.publicKey,null===f||void 0===f?void 0:f.preferredTokenAccounts);case 5:return h=t.sent,O=new o.c(e.authority||l.wallet.publicKey),t.t0=d(m.toString()),t.t1=[h],t.t2=[],t.t3=new o.c(i),t.t4=new o.c(n),t.t5=[b.publicKey],t.t6=[b],t.t7={skipOutTokenCreations:[0]},t.t8=c.a,t.next=18,Object(s.createMintInstructions)(l,O,b.publicKey,p);case 18:return t.t9=t.sent,t.t10=(0,t.t8)(t.t9),t.t11={addDefaultTokAccounts:!1,actionData:t.t0,tokenAccountOuts:t.t1,actionAccounts:t.t2,actionProgram:t.t3,tokenMintIn:t.t4,tokenMintOuts:t.t5,additionalSigners:t.t6,tokenCreationOptions:t.t7,instructions:t.t10},t.abrupt("return",{isolatedAction:t.t11});case 22:case"end":return t.stop()}}),t)})));return function(e,n,r,a,c,i){return t.apply(this,arguments)}}(),d=function(e){return t.from("[".concat(e,"]"))},f={buildIsolatedAction:l,actionTypeUID:"MALLOC_SPL_MINT",expectedNumberOfOutMints:1};e.a=f}).call(this,n(6).Buffer)},451:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return O}));var r=n(0),a=n.n(r),c=n(16),i=n(5),o=n(7),u=n(25),s=n(26),l=n(101),d=n(999),f=n(285),p=n(60),b=n(334),m=function(t){Object(u.a)(n,t);var e=Object(s.a)(n);function n(){return Object(o.a)(this,n),e.apply(this,arguments)}return n}(l.utils.serde.Assignable),h=new Map([[m,{kind:"struct",fields:[["amount_override",{kind:"option",type:"u64"}]]}]]),O={buildIsolatedAction:function(){var e=Object(i.a)(a.a.mark((function e(n,r,i,o,u){var s,O,x,j,v,y,A;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.authoritySecret?p.b.fromSecretKey(new Uint8Array(t.from(n.authoritySecret,"hex"))):void 0,O=n.createMintSecretKey?p.b.fromSecretKey(new Uint8Array(t.from(n.createMintSecretKey,"hex"))):new p.b,e.next=4,l.utils.tokens.getTokenAccountUsedByMalloc(u.wallet.publicKey,O.publicKey);case 4:return x=e.sent,j=l.utils.tokens.fromReadableNumber(parseFloat(n.initialSupply),n.decimals),v=[],y=new p.c(u.wallet.publicKey),A=new p.d,e.t0=A.add,e.t1=A,e.t2=c.a,e.next=14,Object(b.createMintInstructions)(u,y,O.publicKey,n.decimals);case 14:return e.t3=e.sent,e.t4=(0,e.t2)(e.t3),e.t0.apply.call(e.t0,e.t1,e.t4),v.push({tx:A,signers:[O]}),e.abrupt("return",{isolatedAction:{tokenMintIn:new p.c(r),actionData:(a=j,t.from(Object(d.serialize)(h,new m({amount_override:new f.u64(a)})))),actionProgram:new p.c(o),actionAccounts:[{address:O.publicKey,isWriteable:!0},{address:x,isWriteable:!0},{address:(null===s||void 0===s?void 0:s.publicKey)||u.wallet.publicKey,isSigner:!0},{address:f.TOKEN_PROGRAM_ID}],additionalSigners:s?[s]:[],tokenMintOuts:[O.publicKey],tokenAccountOuts:[x],atStartOfPrepareTxs:v}});case 19:case"end":return e.stop()}var a}),e)})));return function(t,n,r,a,c){return e.apply(this,arguments)}}(),actionTypeUID:"MALLOC_SPL_MINT_TO",expectedNumberOfOutMints:1}}).call(this,n(6).Buffer)},452:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return A}));n(13);var r=n(18),a=n(0),c=n.n(a),i=n(5),o=n(60),u=n(285),s=n(215),l=n(101),d=n(499),f=n(290),p=(n(334),function(){var t=Object(i.a)(c.a.mark((function t(e,n,r,a,i,d){var f,p;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.utils.tokens.getTokenAccountUsedByMalloc(i.wallet.publicKey,new o.c(e.outMint),null===d||void 0===d?void 0:d.preferredTokenAccounts);case 2:return f=t.sent,t.next=5,b(e,n,r,f.toBase58(),i);case 5:return p=t.sent,t.abrupt("return",{isolatedAction:{addDefaultTokAccounts:!1,actionData:O(s.b.BasicSwap,p.side,new u.u64(e.minOut)),tokenAccountOuts:[f],actionAccounts:x(p.swapAccounts,p.side),actionProgram:new o.c(a),tokenMintIn:new o.c(n),tokenMintOuts:[new o.c(e.outMint)],preActionTxs:p.openOrderInitTx?[p.openOrderInitTx]:[]}});case 7:case"end":return t.stop()}}),t)})));return function(e,n,r,a,c,i){return t.apply(this,arguments)}}()),b=function(){var t=Object(i.a)(c.a.mark((function t(e,n,a,i,l){var d,p,b,O,x,v,y,A,g,k,w;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return d=new o.c(e.serumDexProgramId),t.next=3,h(l.connection,new o.c(n),new o.c(e.outMint),d);case 3:if(p=t.sent){t.next=6;break}throw"No markets found";case 6:return b=p.side,O=p.pk,t.next=9,f.Market.load(l.connection,O,{},d);case 9:return x=t.sent,t.next=12,m(l.connection,x,l.wallet.publicKey,new o.c(e.serumDexProgramId));case 12:return v=t.sent,t.next=15,j(x.decoded.ownAddress,new o.c(e.serumDexProgramId));case 15:return y=t.sent,A=Object(r.a)(y,2),g=A[0],A[1],k=b===s.a.Bid?i:a,w=b===s.a.Bid?a:i,t.abrupt("return",{market:x,swapAccounts:{market:{market:x.decoded.ownAddress,requestQueue:x.decoded.requestQueue,eventQueue:x.decoded.eventQueue,bids:x.decoded.bids,asks:x.decoded.asks,coinVault:x.decoded.baseVault,pcVault:x.decoded.quoteVault,vaultSigner:g,openOrders:new o.c(e.openOrdersAccount||v.openOrderPk),orderPayerTokenAccount:new o.c(a),coinWallet:new o.c(k)},pcWallet:new o.c(w),authority:l.wallet.publicKey,dexProgram:new o.c(e.serumDexProgramId),tokenProgram:new o.c(u.TOKEN_PROGRAM_ID),rent:new o.c(e.rent)},openOrderInitTx:e.openOrdersAccount?void 0:v.openOrderTx,side:b});case 22:case"end":return t.stop()}}),t)})));return function(e,n,r,a,c){return t.apply(this,arguments)}}(),m=function(){var t=Object(i.a)(c.a.mark((function t(e,n,r,a){var i,u,s;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f.OpenOrders.findForMarketAndOwner(e,n.address,r,a);case 2:if(0!==(i=t.sent).length){t.next=14;break}return u=new o.a((new o.b).secretKey),s=new o.d,t.t0=s,t.next=9,f.OpenOrders.makeCreateAccountTransaction(e,n.decoded.ownAddress,r,u.publicKey,a);case 9:return t.t1=t.sent,t.t0.add.call(t.t0,t.t1),t.abrupt("return",{openOrderPk:u.publicKey,openOrderTx:{tx:s,signers:[u]}});case 14:return t.abrupt("return",{openOrderPk:i[0].publicKey});case 15:case"end":return t.stop()}}),t)})));return function(e,n,r,a){return t.apply(this,arguments)}}(),h=function(){var t=Object(i.a)(c.a.mark((function t(e,n,r,a){var i,o;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=s.a.Ask,t.next=3,y(e,n,r,a);case 3:if((o=t.sent)&&0!==o.length){t.next=9;break}return t.next=7,y(e,r,n,a);case 7:o=t.sent,i=s.a.Bid;case 9:if(o&&0!==o.length){t.next=11;break}return t.abrupt("return",null);case 11:return t.abrupt("return",{pk:o[0],side:i});case 12:case"end":return t.stop()}}),t)})));return function(e,n,r,a){return t.apply(this,arguments)}}(),O=function(e,n,r){var a=r.toArrayLike(t,"be",8),c=t.from(new Uint8Array([e,n]));return t.concat([c,a])},x=function(t,e,n){var r=e===s.a.Bid?t.pcWallet:t.market.coinWallet,a=e===s.a.Bid?t.market.coinWallet:t.pcWallet,c=[{isWriteable:!0,address:r},{address:t.tokenProgram},{address:t.authority,isSigner:!0},{address:t.rent},{address:t.dexProgram},{address:a,isWriteable:!0},{address:t.market.market,isWriteable:!0},{address:t.market.openOrders,isWriteable:!0},{address:t.market.requestQueue,isWriteable:!0},{address:t.market.eventQueue,isWriteable:!0},{address:t.market.bids,isWriteable:!0},{address:t.market.asks,isWriteable:!0},{address:t.market.orderPayerTokenAccount,isWriteable:!0},{address:t.market.coinVault,isWriteable:!0},{address:t.market.pcVault,isWriteable:!0},{address:t.market.vaultSigner}];return n&&c.push({address:n,isWriteable:!0}),c};function j(t,e){return v.apply(this,arguments)}function v(){return(v=Object(i.a)(c.a.mark((function e(n,r){var a,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=new d.a(0);case 1:if(!(a.toNumber()<255)){e.next=14;break}return e.prev=2,e.next=5,o.c.createProgramAddress([n.toBuffer(),a.toArrayLike(t,"le",8)],r);case 5:return i=e.sent,e.abrupt("return",[i,a]);case 9:e.prev=9,e.t0=e.catch(2),a.iaddn(1);case 12:e.next=1;break;case 14:throw new Error("Unable to find nonce");case 15:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}var y=function(){var t=Object(i.a)(c.a.mark((function t(e,n,r,a){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f.Market.getLayout(a);case 2:return t.sent,t.next=5,f.Market.findAccountsByMints(e,n,r,a);case 5:return t.abrupt("return",t.sent.map((function(t){return t.publicKey})));case 6:case"end":return t.stop()}}),t)})));return function(e,n,r,a){return t.apply(this,arguments)}}(),A={buildIsolatedAction:p,actionTypeUID:"MALLOC_SPL_SWAP",expectedNumberOfOutMints:1};e.b=A}).call(this,n(6).Buffer)},461:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return u}));var r=n(0),a=n.n(r),c=n(5),i=n(101),o=n(60),u={buildIsolatedAction:function(){var e=Object(c.a)(a.a.mark((function e(n,r,c,u,s){var l,d,f,p,b;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=new o.c(r),d=new o.c(n.recipientWallet),e.next=4,i.utils.tokens.tryCreateAssociatedAccountInst(l,d,s.connection,s.wallet.publicKey);case 4:return f=e.sent,p=f.associateTokAccount,b=f.instr,e.abrupt("return",{isolatedAction:{addDefaultTokAccounts:!0,tokenMintIn:l,actionData:t.from([]),actionProgram:new o.c(u),actionAccounts:[{address:p,isWriteable:!0}],additionalSigners:[],tokenMintOuts:[],tokenAccountOuts:[],instructions:b&&!d.equals(s.wallet.publicKey)?[b]:void 0}});case 8:case"end":return e.stop()}}),e)})));return function(t,n,r,a,c){return e.apply(this,arguments)}}(),actionTypeUID:"MALLOC_SPL_TRANSFER",expectedNumberOfOutMints:0}}).call(this,n(6).Buffer)},488:function(t){t.exports=JSON.parse('{"version":"0.0.0","name":"malloc","instructions":[{"name":"initConstruction","accounts":[{"name":"construction","isMut":true,"isSigner":false},{"name":"authority","isMut":false,"isSigner":false}],"args":[{"name":"expectedNumbNodes","type":"u32"}]},{"name":"addActions","accounts":[{"name":"construction","isMut":true,"isSigner":false},{"name":"authority","isMut":false,"isSigner":true}],"args":[{"name":"actions","type":{"vec":{"defined":"ActionNode"}}}]},{"name":"prepareConstruction","accounts":[{"name":"construction","isMut":true,"isSigner":false},{"name":"authority","isMut":false,"isSigner":true}],"args":[{"name":"initActionIdx","type":{"vec":"u32"}},{"name":"initSplits","type":{"vec":"u64"}},{"name":"amount","type":"u64"}]},{"name":"processActionNextInReady","accounts":[{"name":"authority","isMut":false,"isSigner":true},{"name":"construction","isMut":true,"isSigner":false},{"name":"actionCtxProxy","accounts":[{"name":"resultAccount","isMut":true,"isSigner":false},{"name":"actionProgram","isMut":false,"isSigner":false}]},{"name":"actionAccounts","dummyVecIndicator":true}],"args":[{"name":"data","type":"bytes"}]},{"name":"processAction","accounts":[{"name":"authority","isMut":false,"isSigner":true},{"name":"construction","isMut":true,"isSigner":false},{"name":"actionCtxProxy","accounts":[{"name":"resultAccount","isMut":true,"isSigner":false},{"name":"actionProgram","isMut":false,"isSigner":false}]},{"name":"actionAccounts","dummyVecIndicator":true}],"args":[{"name":"nextActionIdx","type":"u32"},{"name":"data","type":"bytes"}]},{"name":"closeConstruction","accounts":[{"name":"construction","accounts":[{"name":"construction","isMut":true,"isSigner":false},{"name":"authority","isMut":false,"isSigner":true}]},{"name":"recipient","isMut":false,"isSigner":false}],"args":[]}],"accounts":[{"name":"Construction","type":{"kind":"struct","fields":[{"name":"authority","type":"publicKey"},{"name":"actions","type":{"vec":{"defined":"ActionNode"}}},{"name":"actionCalls","type":{"vec":{"defined":"ActionCall"}}},{"name":"readyCallIdxList","type":{"vec":"u32"}}]}}],"types":[{"name":"ActionNode","type":{"kind":"struct","fields":[{"name":"nextNodes","type":{"vec":{"vec":{"defined":"NextNode"}}}},{"name":"tokenAccount","type":"publicKey"},{"name":"ripeAmount","type":"u32"}]}},{"name":"NextNode","type":{"kind":"struct","fields":[{"name":"actionIdx","type":"u32"},{"name":"fraction","type":"u64"}]}},{"name":"ActionCall","type":{"kind":"struct","fields":[{"name":"callAmount","type":"u64"},{"name":"numbTimesHit","type":"u32"}]}}],"errors":[{"code":300,"name":"IncorrectConstructionShape","msg":"Incorrect construction shape"},{"code":301,"name":"IncorrectNextActionsShape","msg":"Incorrect next actions shape"},{"code":302,"name":"RipeningNotReached","msg":"Ripening amount not met for given next action index"},{"code":303,"name":"ActionIndexNotFoundInNext","msg":"Action index not found in the next action list"},{"code":304,"name":"GivenTokenAccountDoesNotMatchExpected","msg":"Next token does not equal the given token account"},{"code":305,"name":"IncorrectActionResultShape","msg":"Incorrect action result shape"},{"code":306,"name":"NumbAmountsDNENumbNodes","msg":"Number of amounts does not equal number of nodes"},{"code":307,"name":"ReadyCallIdxListEmpty","msg":"Ready call action index list is empty"},{"code":308,"name":"NumbSplitResultAmountsDNENumbNodes","msg":"Number of amounts out from calculating the split does not equal the number of nodes"},{"code":309,"name":"Expected0ForRipeOfInitNodes","msg":"Expected all initial nodes in the construction to have a ripe count of 0"},{"code":310,"name":"CannotChangeTokenAccountAfterBeingSet","msg":"Cannot change the token account of an action call after it is already set"},{"code":311,"name":"ActionHitMoreThanAllowed","msg":"Action hit more times than maximum hit allowed (i.e. the ripe amount)"}],"metadata":{"address":"3PAE1zWeifZJ2Cnv3SGQ2eBPusyVwAGYApc3LyGjK3EC"}}')},490:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(13),a=n(16),c=function(t,e){var n=Object(a.a)(Array(t.length)).fill(0);return i(t.map((function(t,e){return Object(r.a)(Object(r.a)({},t),{},{id:e})})),n,e)},i=function t(e,n,r){if(0===r.length)return[];var c=n.map((function(t,e){return o(r,e)+t})),i=e.filter((function(t){return t.ripeAmount===c[t.id]&&r.includes(t.id)})),u=i.map((function(t){return t.nextNodes.map((function(t){return t.map((function(t){return t.actionIdx}))}))})).flat().flat();return[].concat(Object(a.a)(i.map((function(t){return t.id}))),Object(a.a)(t(e,c,u)))},o=function(t,e){return t.filter((function(t){return t===e})).length}},651:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(261),a=function(t,e){return Math.ceil(r.b*t*(e/r.e))}},822:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return j}));var r=n(13),a=n(0),c=n.n(a),i=n(16),o=n(5),u=n(7),s=n(10),l=n(488),d=n(992),f=n(135),p=n(150),b=n(111),m=n(261),h=n(490),O=n(651),x=n(282),j=function(){function t(e,n){Object(u.a)(this,t),this.MALLOC_PROGRAM_ID=e,this.provider=n,this.mallocProgram=void 0,this.mallocProgram=new f.b(l,e,n)}return Object(s.a)(t,[{key:"buildTxs",value:function(){var t=Object(o.a)(c.a.mark((function t(e){var n,r,a,o,u,s,l,b,m,O,j,S,T,N,C,M,P,K,R,E,_,D,B,L,W,U,F,G=this;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.actions,r=e.initialSplits,a=e.initialActionIndices,o=e.amount,u=e.authority,s=e.amountInAccount,l=e.amountInAuthority,b=e.opts,m=l||this.provider.wallet,O=u||this.provider.wallet,t.next=5,Object(x.createTokenAccountsForActions)(this.provider,O,n,this.provider.wallet,null===b||void 0===b?void 0:b.preferredTokenAccounts);case 5:return j=t.sent,S=j.accounts,T=j.txs,t.next=10,v(this.mallocProgram,O.publicKey,n.length);case 10:if(N=t.sent,C=N.construction,M=N.tx,P=y(this.mallocProgram,C.publicKey,n.map((function(t){return t.actionMetadata})),O),I(a.map((function(t){return n[t]})))){t.next=16;break}throw"Expected all initial token types to be the same";case 16:if(0!==a.length){t.next=18;break}throw"Expected initial actions to have length more than 0";case 18:return K=n[a[0]].tokenMintIn,t.next=21,Object(x.transferToTx)(s,S[K.toBase58()].publicKey,new f.a(o),m);case 21:if(R=t.sent,E=g(this.mallocProgram,C.publicKey,a,r,O,new f.a(o)),(_=Object(h.a)(n.map((function(t){return t.actionMetadata})),a)).length===n.length){t.next=26;break}throw"An error occurred trying to forecast your construction";case 26:return t.next=28,Promise.all(n.map((function(t){return w(new f.b(d,t.actionProgram,G.provider),t.actionMetadata.nextNodes.length)})));case 28:return D=t.sent,B=n.map((function(t,e){var n=t.addDefaultTokAccounts?[{address:S[t.tokenMintIn.toBase58()].publicKey,isWriteable:!0,isSigner:!1},{address:p.b,isWriteable:!1,isSigner:!1},{address:O.publicKey,isSigner:!0,isWriteable:!1}]:[];return{ctx:{resultAccount:D[e].resultAccount.publicKey,actionProgram:t.actionProgram},actionAccounts:[].concat(n,Object(i.a)(t.actionAccounts))}})),L=_.map((function(t){return k(G.mallocProgram,t,C.publicKey,B[t],O,{data:n[t].actionData,instructions:n[t].instructions,additionalSigners:n[t].additionalSigners,preActionTxs:n[t].preActionTxs})})),W=A(n),U=[].concat(Object(i.a)(W),Object(i.a)(T),[R,M,P,E],Object(i.a)(D.map((function(t){return t.tx})))),F=Object(i.a)(L.flat()),t.abrupt("return",{construction:C,txsPrepare:U,txsActionCalls:F,tokenAccounts:S,resultAccounts:D.map((function(t){return t.resultAccount}))});case 35:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"getConstructionState",value:function(){var t=Object(o.a)(c.a.mark((function t(e){var n,r,a;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.mallocProgram.account.construction.fetch(e.construction.publicKey);case 2:return n=t.sent,r=function(t){return{tokenAccount:new b.b(t.tokenAccount).toBase58(),ripeAmount:t.ripeAmount,nextNodes:t.nextNodes.map((function(t){return t.map((function(t){return{actionIdx:t.actionIdx,fraction:new f.a(t.fraction).toString()}}))}))}},a=function(t){return{numbTimesHit:t.numbTimesHit,callAmount:new f.a(t.callAmount).toString()}},t.abrupt("return",{construction:{authority:new b.b(n.authority).toBase58(),actions:n.actions.map(r),actionCalls:n.actionCalls.map(a),readyCallIdxList:n.readyCallIdxList}});case 6:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"deleteEphemeralAccounts",value:function(){var t=Object(o.a)(c.a.mark((function t(e){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(function(t){}),e.construction;case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"sendRequests",value:function(){var t=Object(o.a)(c.a.mark((function t(e,n){var a,o;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.provider;case 2:if(!(e.txsPrepare.length>0)){t.next=8;break}return t.next=5,this.provider.sendAll(e.txsPrepare,Object(r.a)({},(null===n||void 0===n?void 0:n.prepareCommitment)||{}));case 5:t.t0=t.sent,t.next=9;break;case 8:t.t0=[];case 9:if(a=t.t0,!((null===n||void 0===n?void 0:n.onPrepareAccountsDone)&&a.length>0)){t.next=13;break}return t.next=13,n.onPrepareAccountsDone(a);case 13:return t.next=15,this.provider.sendAll(e.txsActionCalls,Object(r.a)({},(null===n||void 0===n?void 0:n.actionCommitment)||{}));case 15:return o=t.sent,t.abrupt("return",[].concat(Object(i.a)(a),Object(i.a)(o)));case 17:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()}]),t}(),v=function(){var t=Object(o.a)(c.a.mark((function t(e,n,r){var a,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=f.d.Keypair.generate(),t.t0=e.transaction,t.t1=r,t.t2={construction:a.publicKey,authority:n,rent:f.d.SYSVAR_RENT_PUBKEY},t.t3=[a],t.next=7,b.c.createAccount({fromPubkey:e.provider.wallet.publicKey,newAccountPubkey:a.publicKey,space:m.a+8,lamports:Object(O.a)(m.a+8,m.c),programId:e.programId});case 7:return t.t4=t.sent,t.t5=[t.t4],t.t6={accounts:t.t2,signers:t.t3,instructions:t.t5},i=t.t0.initConstruction.call(t.t0,t.t1,t.t6),t.abrupt("return",{tx:{tx:i,signers:[a]},construction:a});case 12:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),y=function(t,e,n,r){var a=r.secretKey?[r]:[],c=n.map((function(t){return{ripeAmount:t.ripeAmount,nextNodes:t.nextNodes.map((function(t){return t.map((function(t){return{actionIdx:t.actionIdx,fraction:new p.d(t.fraction)}}))}))}}));return{tx:t.transaction.addActions(c,{accounts:{authority:r.publicKey,construction:e,rent:f.d.SYSVAR_RENT_PUBKEY},signers:a}),signers:a}},A=function(t){return t.map((function(t){return t.atStartOfPrepareTxs||[]})).flat()},g=function(t,e,n,r,a,c){var i=a.secretKey?[a]:[];return{tx:t.transaction.prepareConstruction(n,r.map((function(t){return new f.a(t)})),c,{accounts:{authority:a.publicKey,construction:e,rent:f.d.SYSVAR_RENT_PUBKEY},signers:i}),signers:i}},k=function(e,n,r,a,c,o){var u,s=(null===c||void 0===c?void 0:c.secretKey)?[c]:[],l=(null===(u=o.tokenAuthority)||void 0===u?void 0:u.secretKey)?[o.tokenAuthority]:[],d=o.tokenAuthority?[].concat(l,s):[].concat(s),p=[].concat(Object(i.a)(d),Object(i.a)(o.additionalSigners||[]));return[].concat(Object(i.a)(o.preActionTxs||[]),[{tx:e.transaction.processAction(n,o.data||t.from([]),{accounts:{construction:r,rent:f.d.SYSVAR_RENT_PUBKEY,authority:c.publicKey,actionCtxProxy:a.ctx,actionAccounts:a.actionAccounts},signers:p,instructions:o.instructions||void 0}),signers:p}])},w=function(){var t=Object(o.a)(c.a.mark((function t(e,n){var r,a,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=b.a.generate(),e.provider.connection.getMinimumBalanceForRentExemption,a=S(n),t.t0=e.transaction,t.t1=n,t.t2={result:r.publicKey,rent:f.d.SYSVAR_RENT_PUBKEY},t.next=8,b.c.createAccount({fromPubkey:e.provider.wallet.publicKey,newAccountPubkey:r.publicKey,space:a,lamports:Object(O.a)(a,m.d),programId:e.programId});case 8:return t.t3=t.sent,t.t4=[t.t3],t.t5=[r],t.t6={accounts:t.t2,instructions:t.t4,signers:t.t5},i=t.t0.initResultAccount.call(t.t0,t.t1,t.t6),t.abrupt("return",{tx:{tx:i,signers:[r]},resultAccount:r});case 14:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),S=function(t){return 44+8*t+64},I=function(t){if(0===t.length)return!0;var e=t[0].tokenMintIn.toBase58();return t.every((function(t){return t.tokenMintIn.toBase58()===e}))}}).call(this,n(6).Buffer)},848:function(t,e,n){"use strict";n(849),n(850)},849:function(t,e,n){"use strict";n(13)},850:function(t,e){},851:function(t,e,n){"use strict"},852:function(t,e,n){"use strict";n.r(e),n.d(e,"buildConstructionFromNonUserSpecific",(function(){return m})),n.d(e,"mergeConstructions",(function(){return h}));var r=n(0),a=n.n(r),c=n(16),i=n(5),o=n(13),u=n(111),s=n(120),l=n.n(s),d=n(490),f=n(378),p=n(282),b=function(t,e){var n=function(t,e){return e.map((function(t,e){return t?Object(o.a)(Object(o.a)({},t),{},{idx:e}):t})).filter((function(t){return!!t})).map((function(e){for(var n=[-1,-1],r=0;r<e.actionMetadata.nextNodes.length;r++)if(n[1]=e.actionMetadata.nextNodes[r].map((function(t){return t.actionIdx})).indexOf(t),-1!==n[1]){n[0]=r;break}if(-1!==n[0]&&-1!==n[1])return{idx:e.idx,idxInNextNodes:n}})).filter((function(t){return!!t}))}(t,e).map((function(t){return e[t.idx].tokenMintOuts[t.idxInNextNodes[0]].toBase58()}));if(n.length<1)throw"Expected to find a previous action for a non initial action";var r=n[0];if(!n.every((function(t){return t===r})))throw"Expected all previous mints to be the same for the action";return r},m=function(){var t=Object(i.a)(a.a.mark((function t(e,n,r,i,s,f){var m,h,O,x,j,v,y,A,g,k,w;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((m=Object(d.a)(e.actionDatas.map((function(t){return t.actionMetadata})),e.initialActionIndices)).length===e.actionDatas.length){t.next=3;break}throw"An unexpected error occurred, the order of actions hit should match the length of actions";case 3:h=Object(c.a)(Array(e.actionDatas.length)),O=0;case 5:if(!(O<m.length)){t.next=29;break}if(x=m[m[O]],j=e.initialActionIndices.includes(x)?i:b(x,h),v=e.actionDatas[x],y=n[v.actionTypeUID].buildIsolatedAction){t.next=12;break}throw"Could not find a builder function for action with UID ".concat(v.actionTypeUID);case 12:if(!e.initialActionIndices.includes(O)){t.next=16;break}t.t0=r,t.next=19;break;case 16:return t.next=18,Object(p.getTokenAccountUsedByMalloc)(s.wallet.publicKey,new u.b(j),f);case 18:t.t0=t.sent.toBase58();case 19:return A=t.t0,t.next=22,y(v.buildActionInputs,j,A,v.actionPID,s,{preferredTokenAccounts:f});case 22:g=t.sent,k=g.isolatedAction,w=Object(o.a)(Object(o.a)({},k),{},{actionMetadata:v.actionMetadata}),h[x]=w;case 26:O++,t.next=5;break;case 29:return t.abrupt("return",{actions:h,initialActionIndices:e.initialActionIndices,initialSplits:e.initialSplits,amount:new l.a(e.amount)});case 30:case"end":return t.stop()}}),t)})));return function(e,n,r,a,c,i){return t.apply(this,arguments)}}(),h=function(t,e,n){var r=Object(f.deepCloneObject)(e),a=Object(f.deepCloneObject)(t);if(n.length==r.initialActionIndices.length&&n.length!==r.initialSplits.length)throw"Expected the info to append the child to the parent to provide the same number of indices as the number of initial splits in the child";for(var i=[].concat(Object(c.a)(a.actionDatas),Object(c.a)(r.actionDatas.map((function(t){return Object(o.a)(Object(o.a)({},t),{},{actionMetadata:Object(o.a)(Object(o.a)({},t.actionMetadata),{},{nextNodes:(e=t.actionMetadata.nextNodes,n=a.actionDatas.length,e.map((function(t){return t.map((function(t){return{actionIdx:t.actionIdx+n,fraction:t.fraction}}))})))})});var e,n})))),u=[],s=0;s<n.length;s++)if(n[s].appendToInitial)u.push({idx:s+a.actionDatas.length,fraction:n[s].splitFrac});else{if(!n[s].indexInParent)throw"Expected the appendChildInitToParent to either append to initial or contain info as to where to append in the parent";i[n[s].indexInParent.actionIdx].actionMetadata.nextNodes[n[s].indexInParent.nextNodeIdx].push({fraction:n[s].splitFrac,actionIdx:s+a.actionDatas.length})}return{actionDatas:i,initialActionIndices:[].concat(Object(c.a)(a.initialActionIndices),Object(c.a)(u.map((function(t){return t.idx})))),initialSplits:[].concat(Object(c.a)(a.initialSplits),Object(c.a)(u.map((function(t){return t.fraction})))),amount:a.amount}}},87:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=function(){var t="devnet";return{MALLOC_PROGRAM_ID:"9i4MAnhYagLr1vEo5jdmLehRe8Sm5Lx8fHaQNJfbFCve",mallocSpl:{TRANSFER_PROGRAM_ID:"ETpyJNQLorJbAcrPQpM9bkYxYMakegBh93kqZ1KnTBjr",SWAP_PROGRAM_ID:"7T6seoCvCQeUeSTf2EAwX5SnyrZvX7BFUMHi74ZodBKH",DUMMY_PASS_THROUGH:"DBhGd4VREBAw14vV1yaLXfCTtanPBwQfEErg1fe27diJ",MINT_TO:"77WQMNHSBe6BNdMY8R1FD4JX89o2fXr5FhKNerTcJsHJ"},projectSerum:{DEX_PROGRAM_ID:"DESVgJVGajEgKGXhb6XmqDHGz3VjdgP7rEVESBgxmroY"},demo:{FAKE_USDC:"AkzN2jJrorpUY2ApfL2UsBeTfuv1XHFKGLQurZJg6BhN",FAKE_USDC_GD:"2BB7fDrLgBNSMCLqD835GisCHrHrGHsS8SJr6brtnWk2",FAKE_TOKEN_A:"9GmQdigrAFdX67EMrVFwMepEN8rEdMdp8CPUEPJRY8sj"},INITIAL_SPLITTER_ID_UUID:"initial",solana:{RPC:"https://explorer-api.devnet.solana.com",NETWORK:t}}}},985:function(t,e,n){"use strict";n.r(e),n.d(e,"tokens",(function(){return a})),n.d(e,"serde",(function(){return r})),n.d(e,"object",(function(){return o}));var r={};n.r(r),n.d(r,"Assignable",(function(){return i}));var a=n(282),c=n(7),i=function t(e){var n=this;Object(c.a)(this,t),Object.keys(e).map((function(t){n[t]=e[t]}))},o=n(378)},992:function(t){t.exports=JSON.parse('{"version":"0.0.0","name":"action_template","instructions":[{"name":"initResultAccount","accounts":[{"name":"result","isMut":true,"isSigner":false}],"args":[{"name":"capacity","type":"u32"}]},{"name":"closeResultAccount","accounts":[{"name":"resultAccountCtx","accounts":[{"name":"result","isMut":true,"isSigner":false}]},{"name":"recipient","isMut":false,"isSigner":false}],"args":[]},{"name":"init","accounts":[],"args":[]}],"accounts":[{"name":"ActionResult","type":{"kind":"struct","fields":[{"name":"resultantAmounts","type":{"vec":"u64"}},{"name":"numberOfResults","type":"u32"},{"name":"owner","type":"publicKey"}]}}],"errors":[{"code":300,"name":"AFakeError","msg":"An error here"}],"metadata":{"address":"2ycCHseReeg9gksHY25vVRBr4oDYgUT2WvjyLbNSKW8U"}}')}},[[1630,1,2]]]);
//# sourceMappingURL=main.422f6abe.chunk.js.map