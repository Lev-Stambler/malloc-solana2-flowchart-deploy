(this["webpackJsonpmalloc-flow-2"]=this["webpackJsonpmalloc-flow-2"]||[]).push([[0],{100:function(t,e,n){"use strict";var r=n(818);n.d(e,"MallocSdk",(function(){return r.a}));n(844);var a=n(981);n.d(e,"utils",(function(){return a}));n(847);var c=n(848);n.d(e,"builder",(function(){return c}));n(489)},1081:function(t,e,n){},1082:function(t,e,n){},1085:function(t,e){},1087:function(t,e){},1094:function(t,e){},1109:function(t,e){},1110:function(t,e){},1150:function(t,e){},1151:function(t,e){},1152:function(t,e){},1156:function(t,e){},1175:function(t,e){},1176:function(t,e){},1196:function(t,e){},1197:function(t,e){},1198:function(t,e){},1202:function(t,e){},1219:function(t,e){},1220:function(t,e){},1240:function(t,e){},1241:function(t,e){},1260:function(t,e){},1261:function(t,e){},1281:function(t,e){},1282:function(t,e){},1283:function(t,e){},1289:function(t,e){},1290:function(t,e){},1308:function(t,e){},1309:function(t,e){},1343:function(t,e){},1344:function(t,e){},1345:function(t,e){},1349:function(t,e){},1366:function(t,e){},1367:function(t,e){},1410:function(t,e){},1450:function(t,e){},1451:function(t,e){},1452:function(t,e){},1526:function(t,e){},1528:function(t,e){},1542:function(t,e){},1546:function(t,e){},1548:function(t,e){},1558:function(t,e){},1560:function(t,e){},1591:function(t,e){},1593:function(t,e){},1600:function(t,e){},1601:function(t,e){},1626:function(t,e){},1633:function(t,e,n){"use strict";n.r(e);var r,a=n(2),c=n.n(a),i=n(63),o=n.n(i),s=(n(1081),n(1082),n(1083),n(1084),n(12)),u=n(0),l=n.n(u),d=n(5),f=n(20),p=n(263),b=n(663),m=n(1695),O=n(1704),h=n(54),x=n(142),j=n(475),v=n(384),y=n(17),g=n(136);!function(t){t.actionVertex="ACTION_VERTEX",t.tokenAccount="TOKEN_ACCOUNT",t.mintAccount="MINT_ACCOUNT",t.tokenAccountOnlyInit="TOKEN_ACCOUNT_ONLY_INIT",t.mintAccountOnlyInit="MINT_ACCOUNT_ONLY_INIT",t.wholeNumber="WHOLE_NUMBER",t.fractionNumber="FRACTION_NUMBER",t.other="OTHER"}(r||(r={}));var A=n(994),k=n.n(A),w=function(t,e){if(t){e||(e="console.json"),"object"===typeof t&&(t=JSON.stringify(t,void 0,4));var n=new Blob([t],{type:"text/json"}),r=document.createEvent("MouseEvents"),a=document.createElement("a");a.download=e,a.href=window.URL.createObjectURL(n),a.dataset.downloadurl=["text/json",a.download,a.href].join(":"),r.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),a.dispatchEvent(r)}else console.error("No data")},S=function(){var t=Object(d.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k()({accept:"application/json"});case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),I=function(t){return t[K]},N=function(t){return t[0][1].value},T=function(t){return t[1][1].value},C=function(t){return Object.keys(t)},M=function(t){return t.split("-")[0]},E=function(t,e){return t[e].next_actions.map((function(t){return t.slice(1).map((function(t){return t[1].value||t[0].value?{amount:parseInt(t[1].value),id:t[0].value}:null})).filter((function(t,e){return null!==t}))}))},P=function(t){return[{value:"",className:"".concat(r.actionVertex,"-").concat(t)},{value:"",className:r.wholeNumber}]},K="SOURCE-0",R=[[{value:"NextActionID",readOnly:!0},{value:"Parts of 1,000",readOnly:!0}],P(0)],_={selected:K,counter:1,new_action:"SERUM_SWAP",graph:{},sourceMint:"<UNSET>",hiddenInputData:{}};_.graph[K]={input:[[{value:"InputTokenAccount",readOnly:!0},{value:"",className:r.tokenAccountOnlyInit}],[{value:"Amount",readOnly:!0},{value:"",className:r.fractionNumber}]],next_actions:[R]};var D=new g.Store(_),L=function(){var t=Object(d.a)(l.a.mark((function t(){var e,n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,S();case 2:if(!((e=t.sent).length<1)){t.next=6;break}return alert("Please select a file"),t.abrupt("return");case 6:return t.t0=JSON,t.next=9,e[0].text();case 9:t.t1=t.sent,n=t.t0.parse.call(t.t0,t.t1),console.log(n),n.graph[K].input[0][1].value="",D.setState(n);case 14:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),B=function(){var t=Object(d.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w(JSON.stringify(D.state),"flow.json");case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),U=n(446),W=n(451),F=n(452),G=n(453),Y=n(462),V={},H=function(t){V[t.actionTypeUID]=t};H(G.b),H(Y.a),H(U.a),H(W.a),H(F.a);var J=n(100),Q=n(87),z=["SERUM_SWAP","TRANSFER","MINT","SOLEND DEPOSIT LIQUIDITY"],q=function(t){if("SERUM_SWAP"===t)return G.a.actionTypeUID;if("TRANSFER"===t)return Y.a.actionTypeUID;if("MINT"===t)return W.a.actionTypeUID;if("SOLEND DEPOSIT LIQUIDITY"===t)return F.a.actionTypeUID;throw"unexpected vertex id of ".concat(t)},X=function(t){if("SERUM_SWAP"===t)return Object(Q.a)().mallocSpl.SWAP_PROGRAM_ID;if("TRANSFER"===t)return Object(Q.a)().mallocSpl.TRANSFER_PROGRAM_ID;if("MINT"===t)return Object(Q.a)().mallocSpl.MINT_TO;if("SOLEND DEPOSIT LIQUIDITY"===t)return Object(Q.a)().mallocSpl.SOLEND_ACTION;throw"unexpected vertex id of ".concat(t)},Z=n(21),$=function(){var t=Object(g.useStore)(D),e=z;return Object(Z.jsxs)("div",{className:"card",children:[Object(Z.jsx)("h2",{children:"Node Id"}),Object(Z.jsx)("select",{id:"node-selector",className:"form-select",size:5,"aria-label":"size 3 select example",onChange:function(t){D.setState({selected:t.target.value})},children:Object.keys(t.graph).map((function(t,e){return Object(Z.jsx)("option",{value:t,children:t})}))}),Object(Z.jsx)("br",{}),Object(Z.jsxs)("div",{className:"row",children:[Object(Z.jsx)("div",{className:"col-10",children:Object(Z.jsx)("select",{className:"form-select","aria-label":"Default select example",onChange:function(t){D.setState({new_action:t.target.value})},children:e.map((function(t,e){return Object(Z.jsx)("option",{value:t,children:t})}))})}),Object(Z.jsx)("div",{className:"col-2 justify-content-center",children:Object(Z.jsx)("button",{onClick:function(){var e=t.new_action+"-"+t.counter.toString(),n=function(t){switch(t){case"SOLEND DEPOSIT LIQUIDITY":return{input:[]};case"MINT":return{input:[[{value:"decimals",readOnly:!0},{value:"6",className:r.wholeNumber}],[{value:"initialSupply",readOnly:!0},{value:"",className:r.fractionNumber}]]};case"TRANSFER":return{input:[[{value:"recipientWallet",readOnly:!0},{value:"",className:r.other}]]};case"SERUM_SWAP":return{input:[[{value:"outMint",readOnly:!0},{value:"",className:r.mintAccount}],[{value:"minOut",readOnly:!0},{value:"",className:r.wholeNumber}]],hiddenData:{rent:h.SYSVAR_RENT_PUBKEY.toBase58(),serumDexProgramId:Object(Q.a)().projectSerum.DEX_PROGRAM_ID}};default:throw"Unexpected action type ".concat(t)}}(t.new_action),a={input:n.input,next_actions:Object(y.a)(Array(V[q(t.new_action)].expectedNumberOfOutMints)).map((function(t){return R}))};t.graph[e]=a,t.hiddenInputData[e]=n.hiddenData||{},D.setState(Object(s.a)(Object(s.a)({},t),{},{counter:t.counter+1,graph:Object(s.a)({},t.graph)}))},children:"add"})})]})]})},tt=n(666),et=n(385),nt=n(124),rt=n(668),at=new g.Store({derivedTokenAccounts:null,tokenList:null}),ct=nt.ASSOCIATED_TOKEN_PROGRAM_ID,it=function(){var t=Object(d.a)(l.a.mark((function t(e){var n,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=function(){var t=Object(d.a)(l.a.mark((function t(){var e,n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!at.state.tokenList){t.next=2;break}return t.abrupt("return",at.state.tokenList);case 2:return t.next=4,(new rt.b).resolve();case 4:return e=t.sent,n=e.filterByClusterSlug(Object(Q.a)().solana.NETWORK).getList(),at.setState(Object(s.a)(Object(s.a)({},at.state),{},{tokenList:n})),t.abrupt("return",n);case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),t.next=3,n();case 3:if(r=t.sent,"devnet"!==Object(Q.a)().solana.NETWORK){t.next=15;break}return t.t0=[],t.t1=Object(y.a)(r),t.t2=y.a,t.next=10,ot(e);case 10:return t.t3=t.sent,t.t4=(0,t.t2)(t.t3),t.abrupt("return",t.t0.concat.call(t.t0,t.t1,t.t4));case 15:return t.abrupt("return",r);case 16:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),ot=function(){var t=Object(d.a)(l.a.mark((function t(e){var n,r,a,c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new h.PublicKey(Object(Q.a)().demo.FAKE_USDC),r=new h.PublicKey(Object(Q.a)().demo.FAKE_TOKEN_A),t.next=4,dt(e,n);case 4:return a=t.sent,t.next=7,dt(e,r);case 7:if(c=t.sent,a&&c){t.next=10;break}throw"Expected info for these mints";case 10:return t.abrupt("return",[Object(s.a)(Object(s.a)({},a),{},{chainId:-1,name:"FAKE USDC",symbol:"FUSDC",address:Object(Q.a)().demo.FAKE_USDC}),Object(s.a)(Object(s.a)({},c),{},{chainId:-1,name:"FAKE: A TOKEN",symbol:"FA TOKEN",address:Object(Q.a)().demo.FAKE_TOKEN_A})]);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),st=function(){var t=Object(d.a)(l.a.mark((function t(e,n){var r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.PublicKey.findProgramAddress([e.toBuffer(),nt.TOKEN_PROGRAM_ID.toBuffer(),new h.PublicKey(n).toBuffer()],ct);case 2:return r=t.sent,t.abrupt("return",r[0]);case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),ut=function(){var t=Object(d.a)(l.a.mark((function t(e,n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.all(n.map((function(t){return st(e,t)}))));case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),lt=function(){var t=Object(d.a)(l.a.mark((function t(e,n){var r,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.connection.getAccountInfo(n);case 2:if(r=t.sent){t.next=5;break}return t.abrupt("return",null);case 5:return t.prev=5,a=Object(et.parseTokenAccount)(r.data),t.abrupt("return",a);case 10:return t.prev=10,t.t0=t.catch(5),console.error("An error occured parsing the data, returning null",t.t0),t.abrupt("return",null);case 14:case"end":return t.stop()}}),t,null,[[5,10]])})));return function(e,n){return t.apply(this,arguments)}}(),dt=function(){var t=Object(d.a)(l.a.mark((function t(e,n){var r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.connection.getAccountInfo(n);case 2:if(r=t.sent){t.next=5;break}return t.abrupt("return",null);case 5:return t.abrupt("return",Object(et.parseMintAccount)(r.data));case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),ft=n(132),pt=function(t){return new ft.a(new h.Connection(Object(Q.a)().solana.RPC),t,{})},bt=n(1018),mt=n(1703),Ot=n(1702),ht=n(1005),xt=n.n(ht),jt=n(803),vt=n(980),yt=n(1696);function gt(){return{top:"".concat(50,"%"),left:"".concat(50,"%"),transform:"translate(-".concat(50,"%, -").concat(50,"%)")}}var At=Object(jt.a)((function(t){return Object(vt.a)({paper:{position:"absolute",width:"auto",backgroundColor:t.palette.background.paper,border:"2px solid #000",boxShadow:t.shadows[5],padding:t.spacing(2,4,3)}})})),kt=function(t){var e=t.tok,n=t.setChoosen;return Object(Z.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr 1fr",width:"100%",gap:"5px"},children:[Object(Z.jsx)("button",{onClick:n,children:"Choose"}),Object(Z.jsx)("div",{children:e.info.name}),Object(Z.jsx)("div",{children:Object(v.a)(e.info.mint.toBase58())}),Object(Z.jsxs)("div",{children:[Object(v.a)(e.account),e.balance?"":" (currently nonexistent)"]}),Object(Z.jsx)("div",{children:J.utils.tokens.toReadableNumber(new nt.u64(e.balance||0),e.info.decimals)})]})};function wt(t){var e,n=null===(e=t.onlyWithInitializedAccounts)||void 0===e||e,r=At(),i=c.a.useState(gt),o=Object(f.a)(i,1)[0],u=c.a.useState(!1),p=Object(f.a)(u,2),b=p[0],m=p[1],O=c.a.useState(""),j=Object(f.a)(O,2),v=j[0],y=j[1],A=c.a.useState(""),k=Object(f.a)(A,2),w=k[0],S=k[1],I=Object(x.useAnchorWallet)(),N=Object(a.useState)(-1),T=Object(f.a)(N,2),C=T[0],M=T[1],E=Object(g.useStore)(at),P=pt(I),K=function(){var t=Object(d.a)(l.a.mark((function t(){var e,r,a,c,i,o;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,it(P);case 2:return e=t.sent,t.next=5,ut(null===I||void 0===I?void 0:I.publicKey,e.map((function(t){return t.address})));case 5:return r=t.sent,t.next=8,Promise.all(r.map(function(){var t=Object(d.a)(l.a.mark((function t(e){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,lt(P,e);case 2:return n=t.sent,t.abrupt("return",null===n||void 0===n?void 0:n.amount);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 8:a=t.sent,c=r.map((function(t,n){return{account:t.toBase58(),info:e[n],balance:a[n]}})),i=n?c.filter((function(t){return t.balance})):c,o=i.map((function(t){var e;return Object(s.a)(Object(s.a)({},t),{},{info:Object(s.a)(Object(s.a)({},t.info),{},{mint:new h.PublicKey(t.info.address)}),balance:(null===(e=t.balance)||void 0===e?void 0:e.toString())||null})})),at.setState(Object(s.a)(Object(s.a)({},E),{},{derivedTokenAccounts:o}));case 13:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();Object(a.useEffect)((function(){K()}),[]);Object(a.useRef)(null);var R=function(){var e=Object(d.a)(l.a.mark((function e(){var n,r,a,c,i,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(E.derivedTokenAccounts){e.next=4;break}return m(!1),t.onClose(),e.abrupt("return");case 4:if(!(C>=0)){e.next=8;break}t.onClose(E.derivedTokenAccounts[C]),e.next=45;break;case 8:if(("TOKEN"!==(n=-1===C?"TOKEN":"MINT")||v)&&("MINT"!==n||w)){e.next=13;break}return m(!1),t.onClose(),e.abrupt("return");case 13:if("TOKEN"!==n){e.next=17;break}e.t0=v,e.next=20;break;case 17:return e.next=19,st(I.publicKey,w);case 19:e.t0=e.sent.toBase58();case 20:return r=e.t0,e.next=23,lt(P,new h.PublicKey(r));case 23:if(a=e.sent,"TOKEN"!==n||a){e.next=29;break}return alert("Looks like an invalid SPL Token Account was provided"),m(!1),t.onClose(),e.abrupt("return");case 29:if("MINT"!==n||!1===t.onlyWithInitializedAccounts||a){e.next=34;break}return alert("Looks like there is no initialized associated account with this mint"),m(!1),t.onClose(),e.abrupt("return");case 34:return c="TOKEN"===n?a.mint:new h.PublicKey(w),e.next=37,dt(P,c);case 37:if(i=e.sent){e.next=43;break}return alert("Looks like the mint associated with this token is invalid"),m(!1),t.onClose(),e.abrupt("return");case 43:o=(null===a||void 0===a?void 0:a.amount)||new nt.u64(0),t.onClose({balance:o,account:r,info:Object(s.a)(Object(s.a)({},i),{},{mint:c})});case 45:m(!1),t.onClose();case 47:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_=Object(Z.jsx)("div",{onBlur:R,className:"wrapper",onClick:function(t){return t.currentTarget.blur()},style:{position:"fixed",top:"0",left:"0",height:"100vh",width:"100vw",zIndex:100,display:"grid",justifyItems:"center",justifyContent:"center",alignItems:"center"},children:Object(Z.jsxs)("div",{style:Object(s.a)({},o),className:r.paper,children:[Object(Z.jsx)("h2",{id:"simple-modal-title",children:"Choose a token account"}),Object(Z.jsx)("p",{id:"simple-modal-description",children:"Choose from either your associated token accounts or add a custom address"}),Object(Z.jsxs)("div",{className:"options",style:{overflow:"scroll",maxHeight:"70vh"},children:[Object(Z.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr 1fr"},children:[Object(Z.jsx)("span",{}),Object(Z.jsx)("div",{children:"Mint Name"}),Object(Z.jsx)("div",{children:"Mint Address"}),Object(Z.jsx)("div",{children:"Token Account Address"}),Object(Z.jsx)("div",{children:"Amount"})]}),E.derivedTokenAccounts?E.derivedTokenAccounts.map((function(t,e){return Object(Z.jsxs)("div",{style:{padding:"0.5rem",border:C===e?"1px solid black":"0px"},children:[Object(Z.jsx)(kt,{tok:t,setChoosen:function(){M(e)}}),Object(Z.jsx)("br",{})]},"token-derived-account-".concat(e))})):"Loading...",t.includeCustomTokenAccount&&Object(Z.jsx)("div",{style:{padding:"0.5rem",border:-1===C?"1px solid black":"0px"},children:Object(Z.jsx)(yt.a,{label:"Custom Token Account",value:v,onChange:function(t){return y(t.target.value)},onFocus:function(){return M(-1)}})}),Object(Z.jsx)("p",{children:"Or"}),Object(Z.jsx)("div",{style:{padding:"0.5rem",border:-2===C?"1px solid black":"0px"},children:Object(Z.jsx)(yt.a,{label:"Custom Mint Account",value:w,onChange:function(t){return S(t.target.value)},onFocus:function(){return M(-2)}})})]})]})});return Object(Z.jsxs)("div",{children:[Object(Z.jsx)("button",{type:"button",onClick:function(){K(),m(!0)},children:t.buttonText||"Choose Token Account"}),b&&_]})}var St,It,Nt=function(t){var e;return Object(Z.jsx)(bt.a,{onChange:function(e){t.onChange(Object(s.a)(Object(s.a)({},t.cell),{},{value:t.isWholeNumber?parseInt(e.target.value).toString():e.target.value}))},value:(null===(e=t.cell)||void 0===e?void 0:e.value)||"",type:t.isFractionNumber||t.isWholeNumber?"number":"text"})},Tt=function(t){return Object(Z.jsx)("div",{children:Object(Z.jsx)(wt,{buttonText:"select",onlyWithInitializedAccounts:t.onlyWithInitialized,onClose:function(e){if(e){var n="token"===t.type?e.account:e.info.mint.toBase58();t.onChange(Object(s.a)(Object(s.a)({},t.cell),{},{value:n}))}}})})},Ct=function(t){var e,n=function(t){var e=Object.keys(t),n=e.indexOf(K);return e.splice(n,1),e}(Object(g.useStore)(D).graph),r=Object(a.useState)(!0),c=Object(f.a)(r,2),i=c[0],o=c[1],u=Object(a.useState)(!1),l=Object(f.a)(u,2),d=l[0],p=l[1];return Object(Z.jsx)("div",{children:Object(Z.jsx)(xt.a,{active:i,paused:d,children:Object(Z.jsx)(Ot.a,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:null===(e=t.cell)||void 0===e?void 0:e.value,label:"Age",style:{height:"20px"},children:n.map((function(e){return Object(Z.jsx)("span",{children:Object(Z.jsx)(mt.a,{style:{zIndex:100},value:e,onMouseOver:function(){return p(!0)},onFocus:function(){return function(e){t.onChange(Object(s.a)(Object(s.a)({},t.cell),{},{value:e})),o(!1)}(e)},children:e})},"select-opts-".concat(e))}))})})})},Mt=function(t){var e;switch(((null===(e=t.cell)||void 0===e?void 0:e.className)||"").split("-")[0]){case r.actionVertex:var n=parseInt(t.cell.className.split("-")[1]||"");return Ct(Object(s.a)(Object(s.a)({},t),{},{nextActionMintIdx:n}));case r.mintAccountOnlyInit:return Tt(Object(s.a)(Object(s.a)({},t),{},{type:"mint",onlyWithInitialized:!0}));case r.tokenAccountOnlyInit:return Tt(Object(s.a)(Object(s.a)({},t),{},{type:"token",onlyWithInitialized:!0}));case r.mintAccount:return Tt(Object(s.a)(Object(s.a)({},t),{},{type:"mint",onlyWithInitialized:!1}));case r.tokenAccount:return Tt(Object(s.a)(Object(s.a)({},t),{},{type:"token",onlyWithInitialized:!1}));case r.other:return Nt(t);case r.wholeNumber:return Nt(Object(s.a)(Object(s.a)({},t),{},{isWholeNumber:!0}));case r.fractionNumber:return Nt(Object(s.a)(Object(s.a)({},t),{},{isFractionNumber:!0}));default:return Nt(t)}},Et=function(){var t=Object(g.useStore)(D),e=Object(x.useAnchorWallet)(),n=function(){var n=Object(d.a)(l.a.mark((function n(r){var a,c,i;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.graph[t.selected].input=r,a=t.sourceMint,t.selected!==K){n.next=9;break}if(!(c=N(r))){n.next=9;break}return n.next=7,lt(pt(e),new h.PublicKey(c));case 7:(i=n.sent)&&(a=i.mint.toBase58());case 9:D.setState(Object(s.a)(Object(s.a)({},t),{},{sourceMint:a,graph:Object(s.a)({},t.graph)}));case 10:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}();return Object(Z.jsxs)("div",{className:"card",children:[Object(Z.jsxs)("div",{className:"row",children:[Object(Z.jsx)("div",{className:"col-10",children:Object(Z.jsxs)("h2",{children:[t.selected," info"]})}),Object(Z.jsx)("div",{className:"col-2",children:"SOURCE-0"!=t.selected&&Object(Z.jsx)("button",{onClick:function(){var e=t.selected;if("SOURCE-0"!=e){var n=J.utils.object.deepCloneObject(t.graph);delete n[e];for(var r=0,a=Object.keys(n);r<a.length;r++){var c=a[r],i=n[c].next_actions;if(null!=i&&0!=i.length)for(var o=0;o<i.length;o++)for(var u=1;u<i[o].length;u++){i[o][u][0].value==e&&(console.log(i[o][u][0]),i[o][u][0].value="")}n[c].next_actions=i}D.setState(Object(s.a)(Object(s.a)({},t),{},{selected:"SOURCE-0",graph:n})),console.log(t.graph)}},children:"X"})})]}),t.selected===K&&Object(Z.jsxs)("p",{children:["Source Mint: ",t.sourceMint]}),Object(Z.jsx)("h5",{children:"Input"}),console.log(t.graph[t.selected].input),Object(Z.jsx)(tt.a,{hideColumnIndicators:!0,hideRowIndicators:!0,data:t.graph[t.selected].input,onChange:function(t){return n(t)},DataEditor:Mt}),0!=t.graph[t.selected].next_actions.length&&Object(Z.jsxs)("div",{children:[Object(Z.jsx)("br",{}),Object(Z.jsx)("h5",{children:"Next Action"})]}),t.graph[t.selected].next_actions.map((function(e,n){return Object(Z.jsxs)("div",{children:[Object(Z.jsx)(tt.a,{hideColumnIndicators:!0,hideRowIndicators:!0,data:t.graph[t.selected].next_actions[n],onChange:function(e){t.graph[t.selected].next_actions[n]=e,D.setState(Object(s.a)(Object(s.a)({},t),{},{graph:Object(s.a)({},t.graph)})),console.log(t.graph[t.selected].next_actions)},DataEditor:Mt}),Object(Z.jsx)("br",{}),Object(Z.jsxs)("div",{className:"row",children:[Object(Z.jsx)("div",{className:"col-2",children:Object(Z.jsx)("button",{onClick:function(){t.graph[t.selected].next_actions[n]=[].concat(Object(y.a)(t.graph[t.selected].next_actions[n]),[P(n)]),D.setState(Object(s.a)(Object(s.a)({},t),{},{graph:Object(s.a)({},t.graph)})),console.log("new action",t.graph[t.selected].next_actions)},children:"Add"})}),Object(Z.jsx)("div",{className:"col-2",children:Object(Z.jsx)("button",{onClick:function(){if(t.graph[t.selected].next_actions[n].length>2){var e=t.graph[t.selected].next_actions[n];t.graph[t.selected].next_actions[0]=e.slice(0,e.length-1),D.setState(Object(s.a)(Object(s.a)({},t),{},{graph:Object(s.a)({},t.graph)})),console.log("remove action",t.graph[t.selected].next_actions)}},children:"Remove"})}),Object(Z.jsx)("div",{className:"col"})]})]},"next-action-".concat(n))}))]})},Pt=n(218),Kt=function(t){var e=Object(g.useStore)(D),n=Object(a.useRef)();return Object(a.useEffect)((function(){for(var t=Object.keys(e.graph).map((function(t,e){return{id:t}})),r=[],a=0,c=Object.keys(e.graph);a<c.length;a++){var i=c[a],o=e.graph[i],s=[];if(null!=o.next_actions&&0!=o.next_actions.length)for(var u=1;u<o.next_actions[0].length;u++){var l=o.next_actions[0][u][0].value;""!=l&&l&&s.push({source:i,target:l,type:"0"})}0!=s.length&&(r=r.concat(s))}var d=0==r.length?[{source:"SOURCE-0",target:"SOURCE-0",type:"0"}]:r;console.log("EDGES",r),console.log("LINKS",d);var f={nodes:t,links:d},p=["0"],b=300,m=300,O=Pt.g(p,Pt.h),h=function(t){Math.hypot(t.target.x-t.source.x,t.target.y-t.source.y);return"\n              M".concat(t.source.x,",").concat(t.source.y,"\n              A",0,",",0," 0 0,1 ").concat(t.target.x,",").concat(t.target.y,"\n            ")};d=f.links.map((function(t){return Object.create(t)})),t=f.nodes.map((function(t){return Object.create(t)}));var x=Pt.d(t).force("link",Pt.b(d).id((function(t){return t.id}))).force("charge",Pt.c().strength(-400)).force("x",Pt.e()).force("y",Pt.f()),j=Pt.i(n.current).attr("viewBox",[-150,-150,b,m]).style("font","12px sans-serif");j.append("rect").attr("x",-300).attr("y",-300).attr("width",600).attr("height",600).attr("fill","white"),j.append("defs").selectAll("marker").data(p).join("marker").attr("id",(function(t){return"arrow-".concat(t)})).attr("viewBox","0 -5 10 10").attr("refX",15).attr("refY",-.5).attr("markerWidth",6).attr("markerHeight",6).attr("orient","auto").append("path").attr("fill",O).attr("d","M0,-5L10,0L0,5");var v=j.append("g").attr("fill","none").attr("stroke-width",1.5).selectAll("path").data(d).join("path").attr("stroke",(function(t){return O(t.type)})).attr("marker-end",(function(t){return"url(".concat(new URL("#arrow-".concat(t.type),location),")")})),y=j.append("g").attr("fill","currentColor").attr("stroke-linecap","round").attr("stroke-linejoin","round").selectAll("g").data(t).join("g").call(function(t){return Pt.a().on("start",(function(e,n){e.active||t.alphaTarget(.3).restart(),n.fx=n.x,n.fy=n.y})).on("drag",(function(t,e){e.fx=t.x,e.fy=t.y})).on("end",(function(e,n){e.active||t.alphaTarget(0),n.fx=null,n.fy=null}))}(x));y.append("circle").attr("stroke","white").attr("stroke-width",1.5).attr("r",4),y.append("text").attr("x",8).attr("y","0.31em").text((function(t){return t.id})).clone(!0).lower().attr("fill","none").attr("stroke","white").attr("stroke-width",3),x.on("tick",(function(){v.attr("d",h),y.attr("transform",(function(t){return"translate(".concat(t.x,",").concat(t.y,")")}))}))}),[e]),Object(Z.jsx)("div",{className:"row justify-content-center",children:Object(Z.jsx)("svg",{ref:n})})},Rt=function(t){if(console.error(t),"MALLOC_FLOWCHART_ERROR"!==(null===t||void 0===t?void 0:t.errorType))throw alert("An unexpected error occured: ".concat(t)),t;var e=t;if(alert(e.msg),e.fullError)throw e.fullError},_t=function(t){return Bt("The token account ".concat(t.toString()," does not exist"))},Dt=function(t){return Bt("".concat(t," is not a valid number for the input"))},Lt=function(t,e){return Bt(e?"The mint ".concat(t.toString()," found from token ").concat(e.toString()," does not exist"):"The mint ".concat(t.toString()," does not exist"))},Bt=function(t,e){return{msg:t,fullError:e,type:"MALLOC_FLOWCHART_ERROR"}},Ut=new h.PublicKey(Object(Q.a)().MALLOC_PROGRAM_ID),Wt=function(t){return new J.MallocSdk(Ut,pt(t))},Ft=function(t,e){var n={};return t.map((function(t){n[t[0].value]=t[1].value})),Object(s.a)(Object(s.a)({},n),e)},Gt=function(t,e,n,r){var a=function(t,e){return C(e).filter((function(n){return E(e,n).some((function(e){return e.map((function(t){return t.id})).includes(t)}))}))}(t,n),c=function(t,e,n){return E(n,e).map((function(e){return e.map((function(e){return{actionIdx:t.indexOf(e.id),fraction:e.amount}}))}))}(e,t,n),i=M(t);return{actionTypeUID:q(i),buildActionInputs:Ft(n[t].input,r[t]),actionPID:X(i),actionMetadata:{ripeAmount:a.length,nextNodes:c}}},Yt=function(){var t=Object(d.a)(l.a.mark((function t(e,n,r,a,c,i){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return C(e),t.abrupt("return",{actionDatas:r.map((function(t){return Gt(t,r,e,n)})),initialSplits:a,initialActionIndices:c,amount:i});case 2:case"end":return t.stop()}}),t)})));return function(e,n,r,a,c,i){return t.apply(this,arguments)}}(),Vt=function(){var t=Object(d.a)(l.a.mark((function t(e,n,r,a){var c,i,o,s,u,d,f;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=I(e),t.next=3,lt(a,n);case 3:if(i=t.sent){t.next=6;break}throw _t(n);case 6:return o=i.mint,t.next=9,dt(a,o);case 9:if(s=t.sent){t.next=12;break}throw Lt(o,n);case 12:t.prev=12,u=parseFloat(T(c.input)),t.next=19;break;case 16:throw t.prev=16,t.t0=t.catch(12),Dt(T(c.input));case 19:return d=J.utils.tokens.fromReadableNumber(u,s.decimals),f=E(e,K)[0],t.abrupt("return",{amount:d,initialMint:o,initialSplits:f.map((function(t){return t.amount})),initialActionIndices:f.map((function(t){return r.indexOf(t.id)}))});case 22:case"end":return t.stop()}}),t,null,[[12,16]])})));return function(e,n,r,a){return t.apply(this,arguments)}}(),Ht=function(){var t=Object(d.a)(l.a.mark((function t(e,n){var r,a,c,i,o,s,u,d,f,p,b,m,O,x;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=D.state,a=r.graph,c=r.hiddenInputData,i=new h.PublicKey(N(I(a).input)),o=pt(e),s=C(a),u=s.slice(1),t.next=7,Vt(a,i,u,o);case 7:return d=t.sent,f=d.initialSplits,p=d.initialActionIndices,b=d.initialMint,m=d.amount,t.next=14,Yt(a,c,u,f,p,m);case 14:return O=t.sent,t.next=17,J.builder.buildConstructionFromNonUserSpecific(O,V,i.toBase58(),b.toBase58(),o);case 17:return x=t.sent,t.abrupt("return",{actions:x.actions,initialSplits:x.initialSplits,amount:x.amount,initialActionIndices:x.initialActionIndices,amountInAccount:i,opts:{preferredTokenAccounts:n}});case 19:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),Jt=function(){var t=Object(d.a)(l.a.mark((function t(e,n){var r,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=Wt(n),t.next=3,r.buildTxs(e);case 3:return a=t.sent,t.next=6,r.sendRequests(a,{prepareCommitment:{skipPreflight:!1,preflightCommitment:"single",commitment:"single"},actionCommitment:{skipPreflight:!0,preflightCommitment:"single",commitment:"single"}});case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),Qt=function(){var t=Object(d.a)(l.a.mark((function t(e){var n,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Ht(e);case 3:return n=t.sent,t.next=6,Jt(n,e);case 6:r=t.sent,alert("DONE AND SUCCESSFUL with tx: ".concat(r)),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),Rt(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}(),zt=new Uint8Array([8,57,204,222,105,129,113,8,245,54,20,45,122,175,82,37,32,44,46,6,54,35,168,208,213,194,164,50,97,226,134,119,136,196,213,189,243,233,16,53,22,220,245,4,17,203,251,233,20,7,178,5,36,19,66,89,210,148,19,225,117,61,214,253]),qt=new ft.b(h.Keypair.fromSecretKey(zt)),Xt=function(t){return new et.Provider(new h.Connection(t),qt,{commitment:"confirmed"})},Zt=function(){var t=Object(d.a)(l.a.mark((function t(e){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,$t(new h.PublicKey(Object(Q.a)().demo.FAKE_USDC),e,Xt(Object(Q.a)().solana.RPC));case 3:return n=t.sent,t.next=6,te(new h.PublicKey(Object(Q.a)().demo.FAKE_USDC_GD),[n]);case 6:alert("Done with your airdrop"),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),console.error(t.t0),alert("An error occurred with the airdrop ".concat(JSON.stringify(t.t0)));case 13:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}(),$t=function(){var t=Object(d.a)(l.a.mark((function t(e,n,r){var a,c,i;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.PublicKey.findProgramAddress([n.toBuffer(),nt.TOKEN_PROGRAM_ID.toBuffer(),new h.PublicKey(e).toBuffer()],nt.ASSOCIATED_TOKEN_PROGRAM_ID);case 2:return a=t.sent[0],t.next=5,r.connection.getAccountInfo(a);case 5:if(t.sent){t.next=13;break}return c=nt.Token.createAssociatedTokenAccountInstruction(nt.ASSOCIATED_TOKEN_PROGRAM_ID,nt.TOKEN_PROGRAM_ID,e,a,n,r.wallet.publicKey),(i=new h.Transaction).add(c),t.next=12,r.send(i,[]);case 12:case 13:return t.abrupt("return",a);case 14:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),te=function(){var t=Object(d.a)(l.a.mark((function t(e,n){var r,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return 6,r=4*Math.pow(10,6),a=new h.Transaction,n.map((function(t){a.add(nt.Token.createTransferInstruction(nt.TOKEN_PROGRAM_ID,e,t,qt.publicKey,[],r))})),t.next=6,Xt(Object(Q.a)().solana.RPC).send(a,[],{skipPreflight:!0});case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),ee=function(){Object(g.useStore)(D);var t=Object(x.useAnchorWallet)(),e=Object(a.useState)(!1),n=Object(f.a)(e,2),r=n[0],c=n[1],i=Object(a.useState)(!1),o=Object(f.a)(i,2),s=o[0],u=o[1];return Object(Z.jsxs)("div",{className:"card",children:[Object(Z.jsxs)("div",{className:"row",children:[Object(Z.jsx)("div",{className:"col-8",children:Object(Z.jsx)("h2",{children:"Visualizer"})}),Object(Z.jsx)("div",{className:"col",children:Object(Z.jsx)("button",{onClick:function(){return L()},children:"Import"})}),Object(Z.jsx)("div",{className:"col",children:Object(Z.jsx)("button",{onClick:function(){return B()},children:"Export"})})]}),Object(Z.jsx)(Kt,{}),Object(Z.jsx)("br",{}),Object(Z.jsxs)("div",{className:"row",children:[Object(Z.jsx)("div",{className:"col",children:Object(Z.jsx)("button",{disabled:s,onClick:function(){u(!0),Qt(t).then((function(t){return u(!1)})).catch((function(t){return u(!1)}))},children:s?"Running...":"Compile and Run"})}),Object(Z.jsx)("div",{className:"col",children:Object(Z.jsx)("button",{onClick:function(){c(!0),Zt(t.publicKey).then((function(t){return c(!1)}))},disabled:r,children:r?"Loading Airdrop...":"Airdrop Fake USDC"})}),Object(Z.jsx)("div",{className:"col-6"})]})]})},ne=function(){return Object(Z.jsxs)("div",{className:"container",children:[Object(Z.jsxs)("div",{className:"row",children:[Object(Z.jsx)("div",{className:"col"}),Object(Z.jsxs)("div",{className:"col",children:[Object(Z.jsx)("h1",{children:"MALLOC Protocol"}),Object(Z.jsx)("br",{})]}),Object(Z.jsx)("div",{className:"col"})]}),Object(Z.jsxs)("div",{className:"row",children:[Object(Z.jsx)("div",{className:"col-1"}),Object(Z.jsxs)("div",{className:"col-4",children:[Object(Z.jsx)($,{}),Object(Z.jsx)("br",{}),Object(Z.jsx)(Et,{})]}),Object(Z.jsx)("div",{className:"col-6",children:Object(Z.jsx)(ee,{})}),Object(Z.jsx)("div",{className:"col-1"})]})]})},re=Object(b.a)(j.WalletDialogButton)(St||(St=Object(p.a)([""]))),ae=(b.a.span(It||(It=Object(p.a)([""]))),function(t){var e,n=Object(a.useState)(),r=Object(f.a)(n,2),c=r[0],i=r[1],o=Object(a.useState)(!1),u=Object(f.a)(o,2),p=(u[0],u[1],Object(a.useState)(!1)),b=Object(f.a)(p,2),j=(b[0],b[1],Object(a.useState)(!1)),y=Object(f.a)(j,2),g=(y[0],y[1],Object(a.useState)({open:!1,message:"",severity:void 0})),A=Object(f.a)(g,2),k=A[0],w=A[1],S=Object(x.useWallet)();return Object(a.useEffect)((function(){Object(d.a)(l.a.mark((function e(){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===S||void 0===S?void 0:S.publicKey)){e.next=5;break}return e.next=3,t.connection.getBalance(S.publicKey);case 3:n=e.sent,i(n/h.LAMPORTS_PER_SOL);case 5:case"end":return e.stop()}}),e)})))()}),[S,t.connection]),Object(Z.jsxs)("main",{children:[S.connected&&Object(Z.jsx)("div",{children:Object(Z.jsxs)("p",{style:{marginTop:0},children:["Address: ",Object(v.a)((null===(e=S.publicKey)||void 0===e?void 0:e.toBase58())||"")," ",Object(Z.jsx)("br",{}),"Balance: ",(c||0).toLocaleString()," SOL ",Object(Z.jsx)("br",{}),"WALLET CONNECTED ",Object(Z.jsx)("br",{}),Object(Z.jsx)("a",{href:"https://github.com/Lev-Stambler/malloc-solana2",target:"_blank",children:"Our Github"}),Object(Z.jsx)("br",{}),Object(Z.jsx)("a",{href:"https://twitter.com/MallocProtocol",target:"_blank",children:"Our Twitter"}),Object(Z.jsx)("br",{}),Object(Z.jsx)("a",{href:"mailto:mallocprotocol@gmail.com",target:"_blank",children:"Contact Us"})]})}),!S.connected&&Object(Z.jsx)(re,{children:"Connect Wallet"}),Object(Z.jsx)(m.a,{open:k.open,autoHideDuration:6e3,onClose:function(){return w(Object(s.a)(Object(s.a)({},k),{},{open:!1}))},children:Object(Z.jsx)(O.a,{onClose:function(){return w(Object(s.a)(Object(s.a)({},k),{},{open:!1}))},severity:k.severity,children:k.message})}),Object(Z.jsx)("br",{}),S.connected&&Object(Z.jsx)(ne,{})]})}),ce=n(518),ie=new ft.d.PublicKey(Object(Q.a)().MALLOC_PROGRAM_ID),oe=Object(Q.a)().solana.NETWORK,se=Object(Q.a)().solana.RPC,ue=new ft.d.Connection(se),le=function(){var t=Object(a.useMemo)((function(){return Object(h.clusterApiUrl)(oe)}),[]),e=Object(a.useMemo)((function(){return[Object(ce.getPhantomWallet)(),Object(ce.getSolflareWallet)(),Object(ce.getSolletWallet)()]}),[]);return Object(Z.jsx)(x.ConnectionProvider,{endpoint:t,children:Object(Z.jsx)(x.WalletProvider,{wallets:e,autoConnect:!0,children:Object(Z.jsx)(j.WalletDialogProvider,{children:Object(Z.jsx)(ae,{config:ie,connection:ue,txTimeout:3e4})})})})},de=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,1708)).then((function(e){var n=e.getCLS,r=e.getFID,a=e.getFCP,c=e.getLCP,i=e.getTTFB;n(t),r(t),a(t),c(t),i(t)}))};o.a.render(Object(Z.jsx)(c.a.StrictMode,{children:Object(Z.jsx)(le,{})}),document.getElementById("root")),de()},217:function(t,e,n){"use strict";var r,a;n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return a})),function(t){t[t.Bid=0]="Bid",t[t.Ask=1]="Ask"}(r||(r={})),function(t){t[t.BasicSwap=0]="BasicSwap"}(a||(a={}))},229:function(t,e,n){"use strict";n.r(e),n.d(e,"tryCreateAssociatedAccountInst",(function(){return l})),n.d(e,"tryCreateAssociatedAccount",(function(){return d})),n.d(e,"transferToTx",(function(){return f})),n.d(e,"getTokenAccountUsedByMalloc",(function(){return p})),n.d(e,"createTokenAccountsForActions",(function(){return b})),n.d(e,"toReadableNumber",(function(){return x})),n.d(e,"fromReadableNumber",(function(){return j}));var r=n(17),a=n(0),c=n.n(a),i=n(5),o=n(992),s=n(152),u=n(113),l=function(){var t=Object(i.a)(c.a.mark((function t(e,n,r,a){var i,o;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.b.findProgramAddress([n.toBuffer(),s.b.toBuffer(),new u.b(e).toBuffer()],s.a);case 2:return i=t.sent[0],t.next=5,r.getAccountInfo(i);case 5:if(t.sent){t.next=11;break}return o=s.c.createAssociatedTokenAccountInstruction(s.a,s.b,new u.b(e),i,n,a),t.abrupt("return",{instr:o,associateTokAccount:i});case 11:return t.abrupt("return",{associateTokAccount:i});case 12:case"end":return t.stop()}}),t)})));return function(e,n,r,a){return t.apply(this,arguments)}}(),d=function(){var t=Object(i.a)(c.a.mark((function t(e,n,r){var a,i,o,s;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l(e,n,r.connection,r.wallet.publicKey);case 2:if(a=t.sent,i=a.associateTokAccount,o=a.instr){t.next=7;break}return t.abrupt("return",i);case 7:return(s=new u.d).add(o),t.next=11,r.send(s);case 11:return t.abrupt("return",i);case 12:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),f=function(){var t=Object(i.a)(c.a.mark((function t(e,n,r,a){var i,s,l;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=a.secretKey?[a]:[],s=Object(o.transfer)({source:e,destination:n,amount:r,owner:a.publicKey}),(l=new u.d).add(s),t.abrupt("return",{tx:l,signers:i});case 5:case"end":return t.stop()}}),t)})));return function(e,n,r,a){return t.apply(this,arguments)}}(),p=function(){var t=Object(i.a)(c.a.mark((function t(e,n,r){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r||!r[n.toBase58()]){t.next=2;break}return t.abrupt("return",r[n.toBase58()]);case 2:return t.next=4,m(e,n);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),b=function(){var t=Object(i.a)(c.a.mark((function t(e,n,a,o,l){var d,f,p,b,h,x;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:d=O(a.map((function(t){var e,n,a=[];if(null===(e=t.tokenCreationOptions)||void 0===e?void 0:e.skipOutTokenCreations){var c=t.tokenCreationOptions.skipOutTokenCreations;console.log(c),t.tokenMintOuts.forEach((function(t,e){c.includes(e)||a.push(t)}))}else a.push.apply(a,Object(r.a)(t.tokenMintOuts));return!0===(null===(n=t.tokenCreationOptions)||void 0===n?void 0:n.skipInTokenCreation)||a.push(t.tokenMintIn),a})).flat()),console.log(d),f={},p=0;case 4:if(!(p<d.length)){t.next=17;break}if(b=d[p],!(l||{})[b]){t.next=10;break}f[b]={publicKey:l[b]},t.next=14;break;case 10:return t.next=12,m(n.publicKey,b);case 12:h=t.sent,f[b]={publicKey:h};case 14:p++,t.next=4;break;case 17:return t.next=19,Promise.all(d.map(function(){var t=Object(i.a)(c.a.mark((function t(r){var a,i,l,d;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=f[r].publicKey,t.next=3,e.connection.getAccountInfo(a);case 3:if(!t.sent){t.next=7;break}return console.log("ALREADY EXISTS"),t.abrupt("return",null);case 7:return i=s.c.createAssociatedTokenAccountInstruction(s.a,s.b,new u.b(r),f[r].publicKey,n.publicKey,o.publicKey),(l=new u.d).add(i),d=o.secretKey?[o]:[],t.abrupt("return",{tx:l,signers:d});case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 19:return x=t.sent,t.abrupt("return",{accounts:f,txs:x.filter((function(t){return!!t}))});case 21:case"end":return t.stop()}}),t)})));return function(e,n,r,a,c){return t.apply(this,arguments)}}(),m=function(){var t=Object(i.a)(c.a.mark((function t(e,n){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.b.findProgramAddress([e.toBuffer(),s.b.toBuffer(),new u.b(n).toBuffer()],s.a);case 2:return t.abrupt("return",t.sent[0]);case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),O=function(t){return Object(r.a)(new Set(t.map(h)))},h=function(t){return t.toBase58()},x=function(t,e){var n=t.toString(),r=n.substring(0,n.length-e)||"0",a=n.substring(n.length-e).padStart(e,"0").substring(0,e);return"".concat(function(t){for(var e=/(-?\d+)(\d{3})/;e.test(t);)t=t.replace(e,"$1,$2");return t}(r),".").concat(a).replace(/\.?0*$/,"")},j=function(t,e){var n,r=t.toString().split("."),a=r[0],c=r[1]||"";if(r.length>2||c.length>e)throw new Error("Cannot parse '".concat(t,"' as token amount"));return""===(n=(n=a+c.padEnd(e,"0")).replace(/^0+/,""))?"0":n}},264:function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"d",(function(){return a})),n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return i})),n.d(e,"e",(function(){return o}));var r=2e4,a=5184e5,c=5184e5,i=19.055,o=1728e5},377:function(t,e,n){"use strict";n.r(e),n.d(e,"deepCloneObject",(function(){return r}));var r=function(t){return function t(e){if(null==e||"object"!=typeof e)return e;var n=e.constructor();for(var r in e)n[r]=t(e[r]);return n}(t)}},384:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return a}));n(0),n(5);var r=n(132),a=(n(100),n(124),n(87),n(54),new r.d.PublicKey("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"),new r.d.PublicKey("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;return"".concat(t.slice(0,e),"...").concat(t.slice(-e))})}).call(this,n(6).Buffer)},446:function(t,e,n){"use strict";(function(t){var r=n(0),a=n.n(r),c=n(17),i=n(5),o=n(30),s=n(100),u=n(334),l=function(){var t=Object(i.a)(a.a.mark((function t(e,n,r,i,l,f){var p,b,m,O,h;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return p=parseInt(e.decimals),b=new o.b,m=s.utils.tokens.fromReadableNumber(parseFloat(e.amountOut),p),t.next=5,s.utils.tokens.getTokenAccountUsedByMalloc(l.wallet.publicKey,b.publicKey,null===f||void 0===f?void 0:f.preferredTokenAccounts);case 5:return O=t.sent,h=new o.c(e.authority||l.wallet.publicKey),t.t0=d(m.toString()),t.t1=[O],t.t2=[],t.t3=new o.c(i),t.t4=new o.c(n),t.t5=[b.publicKey],t.t6=[b],t.t7={skipOutTokenCreations:[0]},t.t8=c.a,t.next=18,Object(u.createMintInstructions)(l,h,b.publicKey,p);case 18:return t.t9=t.sent,t.t10=(0,t.t8)(t.t9),t.t11={addDefaultTokAccounts:!1,actionData:t.t0,tokenAccountOuts:t.t1,actionAccounts:t.t2,actionProgram:t.t3,tokenMintIn:t.t4,tokenMintOuts:t.t5,additionalSigners:t.t6,tokenCreationOptions:t.t7,instructions:t.t10},t.abrupt("return",{isolatedAction:t.t11});case 22:case"end":return t.stop()}}),t)})));return function(e,n,r,a,c,i){return t.apply(this,arguments)}}(),d=function(e){return t.from("[".concat(e,"]"))},f={buildIsolatedAction:l,actionTypeUID:"MALLOC_SPL_MINT",expectedNumberOfOutMints:1};e.a=f}).call(this,n(6).Buffer)},451:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return h}));var r=n(0),a=n.n(r),c=n(17),i=n(5),o=n(7),s=n(26),u=n(27),l=n(100),d=n(995),f=n(110),p=n(30),b=n(334),m=function(t){Object(s.a)(n,t);var e=Object(u.a)(n);function n(){return Object(o.a)(this,n),e.apply(this,arguments)}return n}(l.utils.serde.Assignable),O=new Map([[m,{kind:"struct",fields:[["amount_override",{kind:"option",type:"u64"}]]}]]),h={buildIsolatedAction:function(){var e=Object(i.a)(a.a.mark((function e(n,r,i,o,s){var u,h,x,j,v,y,g;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=n.authoritySecret?p.b.fromSecretKey(new Uint8Array(t.from(n.authoritySecret,"hex"))):void 0,h=n.createMintSecretKey?p.b.fromSecretKey(new Uint8Array(t.from(n.createMintSecretKey,"hex"))):new p.b,e.next=4,l.utils.tokens.getTokenAccountUsedByMalloc(s.wallet.publicKey,h.publicKey);case 4:return x=e.sent,j=l.utils.tokens.fromReadableNumber(parseFloat(n.initialSupply),n.decimals),v=[],y=new p.c(s.wallet.publicKey),g=new p.f,e.t0=g.add,e.t1=g,e.t2=c.a,e.next=14,Object(b.createMintInstructions)(s,y,h.publicKey,n.decimals);case 14:return e.t3=e.sent,e.t4=(0,e.t2)(e.t3),e.t0.apply.call(e.t0,e.t1,e.t4),v.push({tx:g,signers:[h]}),e.abrupt("return",{isolatedAction:{tokenMintIn:new p.c(r),actionData:(a=j,t.from(Object(d.serialize)(O,new m({amount_override:new f.u64(a)})))),actionProgram:new p.c(o),actionAccounts:[{address:h.publicKey,isWriteable:!0},{address:x,isWriteable:!0},{address:(null===u||void 0===u?void 0:u.publicKey)||s.wallet.publicKey,isSigner:!0},{address:f.TOKEN_PROGRAM_ID}],additionalSigners:u?[u]:[],tokenMintOuts:[h.publicKey],tokenAccountOuts:[x],atStartOfPrepareTxs:v}});case 19:case"end":return e.stop()}var a}),e)})));return function(t,n,r,a,c){return e.apply(this,arguments)}}(),actionTypeUID:"MALLOC_SPL_MINT_TO",expectedNumberOfOutMints:1}}).call(this,n(6).Buffer)},452:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return d}));var r=n(0),a=n.n(r),c=n(5),i=n(30),o=n(996),s=n(229),u=n(997),l=n(110),d={buildIsolatedAction:function(){var e=Object(c.a)(a.a.mark((function e(n,r,c,d,f,p){var b,m,O,h,x,j,v,y,g,A,k,w;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m=new i.c(r),O=new i.c(c),h=o.devnetConfig,x=null===(b=h.assets.find((function(t){return t.mintAddress===r})))||void 0===b?void 0:b.symbol){e.next=6;break}throw"Looks like solend does not support token of mint ".concat(r);case 6:if(j=h.markets[0],v=j.reserves.find((function(t){return t.asset===x}))){e.next=10;break}throw"Looks like Solend does not have a market for ".concat(x);case 10:return y=new i.c(v.collateralMintAddress),e.next=13,Object(s.getTokenAccountUsedByMalloc)(f.wallet.publicKey,y,p);case 13:if(g=e.sent,A=h.oracles.assets.find((function(t){return t.asset===x}))){e.next=17;break}throw"Could not find the oracle for ".concat(x);case 17:return k=Object(u.a)(new i.c(v.address),new i.c(A.priceAddress)),w=k.data,e.abrupt("return",{isolatedAction:{tokenMintIn:m,actionData:t.from([]),actionProgram:new i.c(d),actionAccounts:[{address:new i.c(h.programID)},{address:m},{address:O,isWriteable:!0},{address:g,isWriteable:!0},{address:new i.c(v.address),isWriteable:!0},{address:new i.c(v.liquidityAddress),isWriteable:!0},{address:y,isWriteable:!0},{address:new i.c(j.address),isWriteable:!1},{address:new i.c(j.authorityAddress)},{address:f.wallet.publicKey,isSigner:!0},{address:i.d},{address:l.TOKEN_PROGRAM_ID}],instructions:[new i.g({data:w,programId:new i.c(h.programID),keys:[{pubkey:new i.c(v.address),isWritable:!0,isSigner:!1},{pubkey:new i.c(A.priceAddress),isWritable:!1,isSigner:!1},{pubkey:new i.c(A.switchboardFeedAddress),isWritable:!1,isSigner:!1},{pubkey:i.d,isSigner:!1,isWritable:!1}]})],additionalSigners:[],tokenMintOuts:[y],tokenAccountOuts:[g]}});case 19:case"end":return e.stop()}}),e)})));return function(t,n,r,a,c,i){return e.apply(this,arguments)}}(),actionTypeUID:"MALLOC_SPL_SOLEND",expectedNumberOfOutMints:1}}).call(this,n(6).Buffer)},453:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return A}));n(12);var r=n(17),a=n(20),c=n(0),i=n.n(c),o=n(5),s=n(30),u=n(110),l=n(217),d=n(100),f=n(500),p=n(291),b=(n(334),function(){var t=Object(o.a)(i.a.mark((function t(e,n,r,a,c,o){var f,p;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.utils.tokens.getTokenAccountUsedByMalloc(c.wallet.publicKey,new s.c(e.outMint),null===o||void 0===o?void 0:o.preferredTokenAccounts);case 2:return f=t.sent,t.next=5,m(e,n,r,f.toBase58(),c);case 5:return p=t.sent,t.abrupt("return",{isolatedAction:{addDefaultTokAccounts:!1,actionData:x(l.b.BasicSwap,p.side,new u.u64(e.minOut)),tokenAccountOuts:[f],actionAccounts:j(p.swapAccounts,p.side),actionProgram:new s.c(a),tokenMintIn:new s.c(n),tokenMintOuts:[new s.c(e.outMint)],preActionTxs:p.openOrderInitTx?[p.openOrderInitTx]:[]}});case 7:case"end":return t.stop()}}),t)})));return function(e,n,r,a,c,i){return t.apply(this,arguments)}}()),m=function(){var t=Object(o.a)(i.a.mark((function t(e,n,r,c,o){var d,f,b,m,x,j,y,g,A,k,w;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return d=new s.c(e.serumDexProgramId),t.next=3,h(o.connection,new s.c(n),new s.c(e.outMint),d);case 3:if(f=t.sent){t.next=6;break}throw"No markets found";case 6:return b=f.side,m=f.pk,t.next=9,p.Market.load(o.connection,m,{},d);case 9:return x=t.sent,t.next=12,O(o.connection,x,o.wallet.publicKey,new s.c(e.serumDexProgramId));case 12:return j=t.sent,t.next=15,v(x.decoded.ownAddress,new s.c(e.serumDexProgramId));case 15:return y=t.sent,g=Object(a.a)(y,2),A=g[0],g[1],k=b===l.a.Bid?c:r,w=b===l.a.Bid?r:c,t.abrupt("return",{market:x,swapAccounts:{market:{market:x.decoded.ownAddress,requestQueue:x.decoded.requestQueue,eventQueue:x.decoded.eventQueue,bids:x.decoded.bids,asks:x.decoded.asks,coinVault:x.decoded.baseVault,pcVault:x.decoded.quoteVault,vaultSigner:A,openOrders:new s.c(e.openOrdersAccount||j.openOrderPk),orderPayerTokenAccount:new s.c(r),coinWallet:new s.c(k)},pcWallet:new s.c(w),authority:o.wallet.publicKey,dexProgram:new s.c(e.serumDexProgramId),tokenProgram:new s.c(u.TOKEN_PROGRAM_ID),rent:new s.c(e.rent)},openOrderInitTx:e.openOrdersAccount?void 0:j.openOrderTx,side:b});case 22:case"end":return t.stop()}}),t)})));return function(e,n,r,a,c){return t.apply(this,arguments)}}(),O=function(){var t=Object(o.a)(i.a.mark((function t(e,n,r,a){var c,o,u;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.OpenOrders.findForMarketAndOwner(e,n.address,r,a);case 2:if(0!==(c=t.sent).length){t.next=14;break}return o=new s.a((new s.b).secretKey),u=new s.f,t.t0=u,t.next=9,p.OpenOrders.makeCreateAccountTransaction(e,n.decoded.ownAddress,r,o.publicKey,a);case 9:return t.t1=t.sent,t.t0.add.call(t.t0,t.t1),t.abrupt("return",{openOrderPk:o.publicKey,openOrderTx:{tx:u,signers:[o]}});case 14:return t.abrupt("return",{openOrderPk:c[0].publicKey});case 15:case"end":return t.stop()}}),t)})));return function(e,n,r,a){return t.apply(this,arguments)}}(),h=function(){var t=Object(o.a)(i.a.mark((function t(e,n,r,a){var c,o;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=l.a.Ask,t.next=3,g(e,n,r,a);case 3:if((o=t.sent)&&0!==o.length){t.next=9;break}return t.next=7,g(e,r,n,a);case 7:o=t.sent,c=l.a.Bid;case 9:if(o&&0!==o.length){t.next=11;break}return t.abrupt("return",null);case 11:return t.abrupt("return",{pk:o[0],side:c});case 12:case"end":return t.stop()}}),t)})));return function(e,n,r,a){return t.apply(this,arguments)}}(),x=function(e,n,a){var c=a.toArrayLike(t,"be",8);return t.from(new Uint8Array([e,n].concat(Object(r.a)(c))))},j=function(t,e,n){var r=e===l.a.Bid?t.pcWallet:t.market.coinWallet,a=e===l.a.Bid?t.market.coinWallet:t.pcWallet,c=[{isWriteable:!0,address:r},{address:t.tokenProgram},{address:t.authority,isSigner:!0},{address:t.rent},{address:t.dexProgram},{address:a,isWriteable:!0},{address:t.market.market,isWriteable:!0},{address:t.market.openOrders,isWriteable:!0},{address:t.market.requestQueue,isWriteable:!0},{address:t.market.eventQueue,isWriteable:!0},{address:t.market.bids,isWriteable:!0},{address:t.market.asks,isWriteable:!0},{address:t.market.orderPayerTokenAccount,isWriteable:!0},{address:t.market.coinVault,isWriteable:!0},{address:t.market.pcVault,isWriteable:!0},{address:t.market.vaultSigner}];return n&&c.push({address:n,isWriteable:!0}),c};function v(t,e){return y.apply(this,arguments)}function y(){return(y=Object(o.a)(i.a.mark((function e(n,r){var a,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=new f.a(0);case 1:if(!(a.toNumber()<255)){e.next=14;break}return e.prev=2,e.next=5,s.c.createProgramAddress([n.toBuffer(),a.toArrayLike(t,"le",8)],r);case 5:return c=e.sent,e.abrupt("return",[c,a]);case 9:e.prev=9,e.t0=e.catch(2),a.iaddn(1);case 12:e.next=1;break;case 14:throw new Error("Unable to find nonce");case 15:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}var g=function(){var t=Object(o.a)(i.a.mark((function t(e,n,r,a){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.Market.getLayout(a);case 2:return t.sent,t.next=5,p.Market.findAccountsByMints(e,n,r,a);case 5:return t.abrupt("return",t.sent.map((function(t){return t.publicKey})));case 6:case"end":return t.stop()}}),t)})));return function(e,n,r,a){return t.apply(this,arguments)}}(),A={buildIsolatedAction:b,actionTypeUID:"MALLOC_SPL_SWAP",expectedNumberOfOutMints:1};e.b=A}).call(this,n(6).Buffer)},462:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return s}));var r=n(0),a=n.n(r),c=n(5),i=n(100),o=n(30),s={buildIsolatedAction:function(){var e=Object(c.a)(a.a.mark((function e(n,r,c,s,u){var l,d,f,p,b;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=new o.c(r),d=new o.c(n.recipientWallet),e.next=4,i.utils.tokens.tryCreateAssociatedAccountInst(l,d,u.connection,u.wallet.publicKey);case 4:return f=e.sent,p=f.associateTokAccount,b=f.instr,e.abrupt("return",{isolatedAction:{addDefaultTokAccounts:!0,tokenMintIn:l,actionData:t.from([]),actionProgram:new o.c(s),actionAccounts:[{address:p,isWriteable:!0}],additionalSigners:[],tokenMintOuts:[],tokenAccountOuts:[],instructions:b&&!d.equals(u.wallet.publicKey)?[b]:void 0}});case 8:case"end":return e.stop()}}),e)})));return function(t,n,r,a,c){return e.apply(this,arguments)}}(),actionTypeUID:"MALLOC_SPL_TRANSFER",expectedNumberOfOutMints:0}}).call(this,n(6).Buffer)},489:function(t){t.exports=JSON.parse('{"version":"0.0.0","name":"malloc","instructions":[{"name":"initConstruction","accounts":[{"name":"construction","isMut":true,"isSigner":false},{"name":"authority","isMut":false,"isSigner":false}],"args":[{"name":"expectedNumbNodes","type":"u32"}]},{"name":"addActions","accounts":[{"name":"construction","isMut":true,"isSigner":false},{"name":"authority","isMut":false,"isSigner":true}],"args":[{"name":"actions","type":{"vec":{"defined":"ActionNode"}}}]},{"name":"prepareConstruction","accounts":[{"name":"construction","isMut":true,"isSigner":false},{"name":"authority","isMut":false,"isSigner":true}],"args":[{"name":"initActionIdx","type":{"vec":"u32"}},{"name":"initSplits","type":{"vec":"u64"}},{"name":"amount","type":"u64"}]},{"name":"processActionNextInReady","accounts":[{"name":"authority","isMut":false,"isSigner":true},{"name":"construction","isMut":true,"isSigner":false},{"name":"actionCtxProxy","accounts":[{"name":"resultAccount","isMut":true,"isSigner":false},{"name":"actionProgram","isMut":false,"isSigner":false}]},{"name":"actionAccounts","dummyVecIndicator":true}],"args":[{"name":"data","type":"bytes"}]},{"name":"processAction","accounts":[{"name":"authority","isMut":false,"isSigner":true},{"name":"construction","isMut":true,"isSigner":false},{"name":"actionCtxProxy","accounts":[{"name":"resultAccount","isMut":true,"isSigner":false},{"name":"actionProgram","isMut":false,"isSigner":false}]},{"name":"actionAccounts","dummyVecIndicator":true}],"args":[{"name":"nextActionIdx","type":"u32"},{"name":"data","type":"bytes"}]},{"name":"closeConstruction","accounts":[{"name":"construction","accounts":[{"name":"construction","isMut":true,"isSigner":false},{"name":"authority","isMut":false,"isSigner":true}]},{"name":"recipient","isMut":false,"isSigner":false}],"args":[]}],"accounts":[{"name":"Construction","type":{"kind":"struct","fields":[{"name":"authority","type":"publicKey"},{"name":"actions","type":{"vec":{"defined":"ActionNode"}}},{"name":"actionCalls","type":{"vec":{"defined":"ActionCall"}}},{"name":"readyCallIdxList","type":{"vec":"u32"}}]}}],"types":[{"name":"ActionNode","type":{"kind":"struct","fields":[{"name":"nextNodes","type":{"vec":{"vec":{"defined":"NextNode"}}}},{"name":"tokenAccount","type":"publicKey"},{"name":"ripeAmount","type":"u32"}]}},{"name":"NextNode","type":{"kind":"struct","fields":[{"name":"actionIdx","type":"u32"},{"name":"fraction","type":"u64"}]}},{"name":"ActionCall","type":{"kind":"struct","fields":[{"name":"callAmount","type":"u64"},{"name":"numbTimesHit","type":"u32"}]}}],"errors":[{"code":300,"name":"IncorrectConstructionShape","msg":"Incorrect construction shape"},{"code":301,"name":"IncorrectNextActionsShape","msg":"Incorrect next actions shape"},{"code":302,"name":"RipeningNotReached","msg":"Ripening amount not met for given next action index"},{"code":303,"name":"ActionIndexNotFoundInNext","msg":"Action index not found in the next action list"},{"code":304,"name":"GivenTokenAccountDoesNotMatchExpected","msg":"Next token does not equal the given token account"},{"code":305,"name":"IncorrectActionResultShape","msg":"Incorrect action result shape"},{"code":306,"name":"NumbAmountsDNENumbNodes","msg":"Number of amounts does not equal number of nodes"},{"code":307,"name":"ReadyCallIdxListEmpty","msg":"Ready call action index list is empty"},{"code":308,"name":"NumbSplitResultAmountsDNENumbNodes","msg":"Number of amounts out from calculating the split does not equal the number of nodes"},{"code":309,"name":"Expected0ForRipeOfInitNodes","msg":"Expected all initial nodes in the construction to have a ripe count of 0"},{"code":310,"name":"CannotChangeTokenAccountAfterBeingSet","msg":"Cannot change the token account of an action call after it is already set"},{"code":311,"name":"ActionHitMoreThanAllowed","msg":"Action hit more times than maximum hit allowed (i.e. the ripe amount)"}],"metadata":{"address":"3PAE1zWeifZJ2Cnv3SGQ2eBPusyVwAGYApc3LyGjK3EC"}}')},491:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n(12),a=n(17),c=function(t,e){var n=Object(a.a)(Array(t.length)).fill(0);return i(t.map((function(t,e){return Object(r.a)(Object(r.a)({},t),{},{id:e})})),n,e)},i=function t(e,n,r){if(0===r.length)return[];var c=n.map((function(t,e){return o(r,e)+t})),i=e.filter((function(t){return t.ripeAmount===c[t.id]&&r.includes(t.id)})),s=i.map((function(t){return t.nextNodes.map((function(t){return t.map((function(t){return t.actionIdx}))}))})).flat().flat();return[].concat(Object(a.a)(i.map((function(t){return t.id}))),Object(a.a)(t(e,c,s)))},o=function(t,e){return t.filter((function(t){return t===e})).length}},652:function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var r=n(264),a=function(t,e){return Math.ceil(r.b*t*(e/r.e))}},818:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return j}));var r=n(12),a=n(0),c=n.n(a),i=n(17),o=n(5),s=n(7),u=n(10),l=n(489),d=n(988),f=n(137),p=n(152),b=n(113),m=n(264),O=n(491),h=n(652),x=n(229),j=function(){function t(e,n){Object(s.a)(this,t),this.MALLOC_PROGRAM_ID=e,this.provider=n,this.mallocProgram=void 0,this.mallocProgram=new f.b(l,e,n)}return Object(u.a)(t,[{key:"buildTxs",value:function(){var t=Object(o.a)(c.a.mark((function t(e){var n,r,a,o,s,u,l,b,m,h,j,S,N,T,C,M,E,P,K,R,_,D,L,B,U,W,F,G=this;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.actions,r=e.initialSplits,a=e.initialActionIndices,o=e.amount,s=e.authority,u=e.amountInAccount,l=e.amountInAuthority,b=e.opts,m=l||this.provider.wallet,h=s||this.provider.wallet,t.next=5,Object(x.createTokenAccountsForActions)(this.provider,h,n,this.provider.wallet,null===b||void 0===b?void 0:b.preferredTokenAccounts);case 5:return j=t.sent,S=j.accounts,N=j.txs,t.next=10,v(this.mallocProgram,h.publicKey,n.length);case 10:if(T=t.sent,C=T.construction,M=T.tx,E=y(this.mallocProgram,C.publicKey,n.map((function(t){return t.actionMetadata})),h),I(a.map((function(t){return n[t]})))){t.next=16;break}throw"Expected all initial token types to be the same";case 16:if(0!==a.length){t.next=18;break}throw"Expected initial actions to have length more than 0";case 18:return P=n[a[0]].tokenMintIn,t.next=21,Object(x.transferToTx)(u,S[P.toBase58()].publicKey,new f.a(o),m);case 21:if(K=t.sent,R=A(this.mallocProgram,C.publicKey,a,r,h,new f.a(o)),(_=Object(O.a)(n.map((function(t){return t.actionMetadata})),a)).length===n.length){t.next=26;break}throw"An error occurred trying to forecast your construction";case 26:return t.next=28,Promise.all(n.map((function(t){return w(new f.b(d,t.actionProgram,G.provider),t.actionMetadata.nextNodes.length)})));case 28:return D=t.sent,L=n.map((function(t,e){var n=t.addDefaultTokAccounts?[{address:S[t.tokenMintIn.toBase58()].publicKey,isWriteable:!0,isSigner:!1},{address:p.b,isWriteable:!1,isSigner:!1},{address:h.publicKey,isSigner:!0,isWriteable:!1}]:[];return{ctx:{resultAccount:D[e].resultAccount.publicKey,actionProgram:t.actionProgram},actionAccounts:[].concat(n,Object(i.a)(t.actionAccounts))}})),B=_.map((function(t){return k(G.mallocProgram,t,C.publicKey,L[t],h,{data:n[t].actionData,instructions:n[t].instructions,additionalSigners:n[t].additionalSigners,preActionTxs:n[t].preActionTxs})})),U=g(n),W=[].concat(Object(i.a)(U),Object(i.a)(N),[K,M,E,R],Object(i.a)(D.map((function(t){return t.tx})))),F=Object(i.a)(B.flat()),t.abrupt("return",{construction:C,txsPrepare:W,txsActionCalls:F,tokenAccounts:S,resultAccounts:D.map((function(t){return t.resultAccount}))});case 35:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"getConstructionState",value:function(){var t=Object(o.a)(c.a.mark((function t(e){var n,r,a;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.mallocProgram.account.construction.fetch(e.construction.publicKey);case 2:return n=t.sent,r=function(t){return{tokenAccount:new b.b(t.tokenAccount).toBase58(),ripeAmount:t.ripeAmount,nextNodes:t.nextNodes.map((function(t){return t.map((function(t){return{actionIdx:t.actionIdx,fraction:new f.a(t.fraction).toString()}}))}))}},a=function(t){return{numbTimesHit:t.numbTimesHit,callAmount:new f.a(t.callAmount).toString()}},t.abrupt("return",{construction:{authority:new b.b(n.authority).toBase58(),actions:n.actions.map(r),actionCalls:n.actionCalls.map(a),readyCallIdxList:n.readyCallIdxList}});case 6:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"deleteEphemeralAccounts",value:function(){var t=Object(o.a)(c.a.mark((function t(e){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(function(t){}),e.construction;case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"sendRequests",value:function(){var t=Object(o.a)(c.a.mark((function t(e,n){var a,o;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.provider;case 2:if(!(e.txsPrepare.length>0)){t.next=8;break}return t.next=5,this.provider.sendAll(e.txsPrepare,Object(r.a)({},(null===n||void 0===n?void 0:n.prepareCommitment)||{}));case 5:t.t0=t.sent,t.next=9;break;case 8:t.t0=[];case 9:if(a=t.t0,!((null===n||void 0===n?void 0:n.onPrepareAccountsDone)&&a.length>0)){t.next=13;break}return t.next=13,n.onPrepareAccountsDone(a);case 13:return t.next=15,this.provider.sendAll(e.txsActionCalls,Object(r.a)({},(null===n||void 0===n?void 0:n.actionCommitment)||{}));case 15:return o=t.sent,t.abrupt("return",[].concat(Object(i.a)(a),Object(i.a)(o)));case 17:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()}]),t}(),v=function(){var t=Object(o.a)(c.a.mark((function t(e,n,r){var a,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=f.d.Keypair.generate(),t.t0=e.transaction,t.t1=r,t.t2={construction:a.publicKey,authority:n,rent:f.d.SYSVAR_RENT_PUBKEY},t.t3=[a],t.next=7,b.c.createAccount({fromPubkey:e.provider.wallet.publicKey,newAccountPubkey:a.publicKey,space:m.a+8,lamports:Object(h.a)(m.a+8,m.c),programId:e.programId});case 7:return t.t4=t.sent,t.t5=[t.t4],t.t6={accounts:t.t2,signers:t.t3,instructions:t.t5},i=t.t0.initConstruction.call(t.t0,t.t1,t.t6),t.abrupt("return",{tx:{tx:i,signers:[a]},construction:a});case 12:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),y=function(t,e,n,r){var a=r.secretKey?[r]:[],c=n.map((function(t){return{ripeAmount:t.ripeAmount,nextNodes:t.nextNodes.map((function(t){return t.map((function(t){return{actionIdx:t.actionIdx,fraction:new p.d(t.fraction)}}))}))}}));return{tx:t.transaction.addActions(c,{accounts:{authority:r.publicKey,construction:e,rent:f.d.SYSVAR_RENT_PUBKEY},signers:a}),signers:a}},g=function(t){return t.map((function(t){return t.atStartOfPrepareTxs||[]})).flat()},A=function(t,e,n,r,a,c){var i=a.secretKey?[a]:[];return{tx:t.transaction.prepareConstruction(n,r.map((function(t){return new f.a(t)})),c,{accounts:{authority:a.publicKey,construction:e,rent:f.d.SYSVAR_RENT_PUBKEY},signers:i}),signers:i}},k=function(e,n,r,a,c,o){var s,u=(null===c||void 0===c?void 0:c.secretKey)?[c]:[],l=(null===(s=o.tokenAuthority)||void 0===s?void 0:s.secretKey)?[o.tokenAuthority]:[],d=o.tokenAuthority?[].concat(l,u):[].concat(u),p=[].concat(Object(i.a)(d),Object(i.a)(o.additionalSigners||[]));return[].concat(Object(i.a)(o.preActionTxs||[]),[{tx:e.transaction.processAction(n,o.data||t.from([]),{accounts:{construction:r,rent:f.d.SYSVAR_RENT_PUBKEY,authority:c.publicKey,actionCtxProxy:a.ctx,actionAccounts:a.actionAccounts},signers:p,instructions:o.instructions||void 0}),signers:p}])},w=function(){var t=Object(o.a)(c.a.mark((function t(e,n){var r,a,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=b.a.generate(),e.provider.connection.getMinimumBalanceForRentExemption,a=S(n),t.t0=e.transaction,t.t1=n,t.t2={result:r.publicKey,rent:f.d.SYSVAR_RENT_PUBKEY},t.next=8,b.c.createAccount({fromPubkey:e.provider.wallet.publicKey,newAccountPubkey:r.publicKey,space:a,lamports:Object(h.a)(a,m.d),programId:e.programId});case 8:return t.t3=t.sent,t.t4=[t.t3],t.t5=[r],t.t6={accounts:t.t2,instructions:t.t4,signers:t.t5},i=t.t0.initResultAccount.call(t.t0,t.t1,t.t6),t.abrupt("return",{tx:{tx:i,signers:[r]},resultAccount:r});case 14:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),S=function(t){return 44+8*t+64},I=function(t){if(0===t.length)return!0;var e=t[0].tokenMintIn.toBase58();return t.every((function(t){return t.tokenMintIn.toBase58()===e}))}}).call(this,n(6).Buffer)},844:function(t,e,n){"use strict";n(845),n(846)},845:function(t,e,n){"use strict";n(12)},846:function(t,e){},847:function(t,e,n){"use strict"},848:function(t,e,n){"use strict";n.r(e),n.d(e,"buildConstructionFromNonUserSpecific",(function(){return m})),n.d(e,"mergeConstructions",(function(){return O}));var r=n(0),a=n.n(r),c=n(17),i=n(5),o=n(12),s=n(113),u=n(122),l=n.n(u),d=n(491),f=n(377),p=n(229),b=function(t,e){var n=function(t,e){return e.map((function(t,e){return t?Object(o.a)(Object(o.a)({},t),{},{idx:e}):t})).filter((function(t){return!!t})).map((function(e){for(var n=[-1,-1],r=0;r<e.actionMetadata.nextNodes.length;r++)if(n[1]=e.actionMetadata.nextNodes[r].map((function(t){return t.actionIdx})).indexOf(t),-1!==n[1]){n[0]=r;break}if(-1!==n[0]&&-1!==n[1])return{idx:e.idx,idxInNextNodes:n}})).filter((function(t){return!!t}))}(t,e).map((function(t){return e[t.idx].tokenMintOuts[t.idxInNextNodes[0]].toBase58()}));if(n.length<1)throw"Expected to find a previous action for a non initial action";var r=n[0];if(!n.every((function(t){return t===r})))throw"Expected all previous mints to be the same for the action";return r},m=function(){var t=Object(i.a)(a.a.mark((function t(e,n,r,i,u,f){var m,O,h,x,j,v,y,g,A,k,w;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((m=Object(d.a)(e.actionDatas.map((function(t){return t.actionMetadata})),e.initialActionIndices)).length===e.actionDatas.length){t.next=3;break}throw"An unexpected error occurred, the order of actions hit should match the length of actions";case 3:O=Object(c.a)(Array(e.actionDatas.length)),h=0;case 5:if(!(h<m.length)){t.next=29;break}if(x=m[h],j=e.initialActionIndices.includes(x)?i:b(x,O),v=e.actionDatas[x],y=n[v.actionTypeUID].buildIsolatedAction){t.next=12;break}throw"Could not find a builder function for action with UID ".concat(v.actionTypeUID);case 12:if(!e.initialActionIndices.includes(x)){t.next=16;break}t.t0=r,t.next=19;break;case 16:return t.next=18,Object(p.getTokenAccountUsedByMalloc)(u.wallet.publicKey,new s.b(j),f);case 18:t.t0=t.sent.toBase58();case 19:return g=t.t0,t.next=22,y(v.buildActionInputs,j,g,v.actionPID,u,{preferredTokenAccounts:f});case 22:A=t.sent,k=A.isolatedAction,w=Object(o.a)(Object(o.a)({},k),{},{actionMetadata:v.actionMetadata}),O[x]=w;case 26:h++,t.next=5;break;case 29:return t.abrupt("return",{actions:O,initialActionIndices:e.initialActionIndices,initialSplits:e.initialSplits,amount:new l.a(e.amount)});case 30:case"end":return t.stop()}}),t)})));return function(e,n,r,a,c,i){return t.apply(this,arguments)}}(),O=function(t,e,n){var r=Object(f.deepCloneObject)(e),a=Object(f.deepCloneObject)(t);if(n.length==r.initialActionIndices.length&&n.length!==r.initialSplits.length)throw"Expected the info to append the child to the parent to provide the same number of indices as the number of initial splits in the child";for(var i=[].concat(Object(c.a)(a.actionDatas),Object(c.a)(r.actionDatas.map((function(t){return Object(o.a)(Object(o.a)({},t),{},{actionMetadata:Object(o.a)(Object(o.a)({},t.actionMetadata),{},{nextNodes:(e=t.actionMetadata.nextNodes,n=a.actionDatas.length,e.map((function(t){return t.map((function(t){return{actionIdx:t.actionIdx+n,fraction:t.fraction}}))})))})});var e,n})))),s=[],u=0;u<n.length;u++)if(n[u].appendToInitial)s.push({idx:u+a.actionDatas.length,fraction:n[u].splitFrac});else{if(!n[u].indexInParent)throw"Expected the appendChildInitToParent to either append to initial or contain info as to where to append in the parent";i[n[u].indexInParent.actionIdx].actionMetadata.nextNodes[n[u].indexInParent.nextNodeIdx].push({fraction:n[u].splitFrac,actionIdx:u+a.actionDatas.length})}return{actionDatas:i,initialActionIndices:[].concat(Object(c.a)(a.initialActionIndices),Object(c.a)(s.map((function(t){return t.idx})))),initialSplits:[].concat(Object(c.a)(a.initialSplits),Object(c.a)(s.map((function(t){return t.fraction})))),amount:a.amount}}},87:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var r=function(){var t="devnet";return{MALLOC_PROGRAM_ID:"9i4MAnhYagLr1vEo5jdmLehRe8Sm5Lx8fHaQNJfbFCve",mallocSpl:{TRANSFER_PROGRAM_ID:"ETpyJNQLorJbAcrPQpM9bkYxYMakegBh93kqZ1KnTBjr",SWAP_PROGRAM_ID:"7T6seoCvCQeUeSTf2EAwX5SnyrZvX7BFUMHi74ZodBKH",DUMMY_PASS_THROUGH:"DBhGd4VREBAw14vV1yaLXfCTtanPBwQfEErg1fe27diJ",MINT_TO:"77WQMNHSBe6BNdMY8R1FD4JX89o2fXr5FhKNerTcJsHJ",SOLEND_ACTION:"BVmJHQLHAAdgALGi6rdGxdsk5ate41kbpDMGL9XAVanP"},projectSerum:{DEX_PROGRAM_ID:"DESVgJVGajEgKGXhb6XmqDHGz3VjdgP7rEVESBgxmroY"},demo:{FAKE_USDC:"AkzN2jJrorpUY2ApfL2UsBeTfuv1XHFKGLQurZJg6BhN",FAKE_USDC_GD:"2BB7fDrLgBNSMCLqD835GisCHrHrGHsS8SJr6brtnWk2",FAKE_TOKEN_A:"9GmQdigrAFdX67EMrVFwMepEN8rEdMdp8CPUEPJRY8sj"},INITIAL_SPLITTER_ID_UUID:"initial",solana:{RPC:"https://explorer-api.devnet.solana.com",NETWORK:t}}}},981:function(t,e,n){"use strict";n.r(e),n.d(e,"tokens",(function(){return a})),n.d(e,"serde",(function(){return r})),n.d(e,"object",(function(){return o}));var r={};n.r(r),n.d(r,"Assignable",(function(){return i}));var a=n(229),c=n(7),i=function t(e){var n=this;Object(c.a)(this,t),Object.keys(e).map((function(t){n[t]=e[t]}))},o=n(377)},988:function(t){t.exports=JSON.parse('{"version":"0.0.0","name":"action_template","instructions":[{"name":"initResultAccount","accounts":[{"name":"result","isMut":true,"isSigner":false}],"args":[{"name":"capacity","type":"u32"}]},{"name":"closeResultAccount","accounts":[{"name":"resultAccountCtx","accounts":[{"name":"result","isMut":true,"isSigner":false}]},{"name":"recipient","isMut":false,"isSigner":false}],"args":[]},{"name":"init","accounts":[],"args":[]}],"accounts":[{"name":"ActionResult","type":{"kind":"struct","fields":[{"name":"resultantAmounts","type":{"vec":"u64"}},{"name":"numberOfResults","type":"u32"},{"name":"owner","type":"publicKey"}]}}],"errors":[{"code":300,"name":"AFakeError","msg":"An error here"}],"metadata":{"address":"2ycCHseReeg9gksHY25vVRBr4oDYgUT2WvjyLbNSKW8U"}}')}},[[1633,1,2]]]);
//# sourceMappingURL=main.6a624438.chunk.js.map